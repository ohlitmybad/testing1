<!DOCTYPE html>
<html>
<head>	
  <meta name="language" content="en">
<link rel="canonical" href="https://datamb.football/[PLAYER_NAME_LINK]_Team_stats/" />
<link rel="alternate" hreflang="x-default" href="https://datamb.football/[PLAYER_NAME_LINK]_Team_stats/" />
<link rel="alternate" hreflang="en" href="https://datamb.football/[PLAYER_NAME_LINK]_Team_stats/?lang=en" /> 
<link rel="alternate" hreflang="fr" href="https://datamb.football/[PLAYER_NAME_LINK]_Team_stats/?lang=fr" />
<link rel="alternate" hreflang="es" href="https://datamb.football/[PLAYER_NAME_LINK]_Team_stats/?lang=es" /> 
<link rel="alternate" hreflang="tr" href="https://datamb.football/[PLAYER_NAME_LINK]_Team_stats/?lang=tr" />
<link rel="alternate" hreflang="de" href="https://datamb.football/[PLAYER_NAME_LINK]_Team_stats/?lang=de" />
<link rel="alternate" hreflang="it" href="https://datamb.football/[PLAYER_NAME_LINK]_Team_stats/?lang=it" />
<link rel="alternate" hreflang="pt" href="https://datamb.football/[PLAYER_NAME_LINK]_Team_stats/?lang=pt" />
<link rel="alternate" hreflang="id" href="https://datamb.football/[PLAYER_NAME_LINK]_Team_stats/?lang=id" /> 
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title data-i18n="meta.title" data-template="prefix-name">Arsenal Football Stats and Visuals | DataMB</title>
  <link rel="shortcut icon" type="image/x-icon" href="https://datamb.football/favicon.ico">
  <meta name="description" data-i18n="meta.tdescription" data-template="prefix-name" content="Arsenal 2025/26 data profile compared to other teams in Europe's Top 7 Leagues. Check out Arsenal statistics with our radar chart and plots, or compare Arsenal to other teams using our data comparison tool.">
  <meta property="og:image" content="https://datamb.football/vignettes/teamprofile.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@DataMB_">
  <meta name="twitter:title" content="Arsenal | DataMB">
  <meta name="twitter:image" content="https://datamb.football/vignettes/teamprofile.png">
  <script>
    // Store template information before player names are replaced
    document.addEventListener('DOMContentLoaded', function() {
      // Store template information for elements with data-template attribute
      document.querySelectorAll('[data-template]').forEach(element => {
        const templateType = element.getAttribute('data-template');
        
        // Store the template pattern
        if (templateType === 'prefix-name') {
          // For elements where player name is at the beginning
          element.setAttribute('data-name-position', 'prefix');
        }
      });
    });

    const width1 = window.innerWidth;

if (width1 <= 681) {
  const scale = width1 / 681;
  const widthPercent = 100 / scale;

  document.documentElement.style.setProperty('--dynamic-width', widthPercent + '%');
  document.documentElement.style.setProperty('--dynamic-scale', scale);
}
  </script>
<link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
<script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
<script src="https://d3js.org/d3.v5.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>


<style>


  
.footer {
    font-family: system-ui;
    background: #F2F2F2;
    padding: 20px;
    text-align: center;
    color: #fff;
  }
  
  .footer {
    left: 0;
    right: 0;
    bottom: 0;
  }
  
  .footer .logo {
    display: flex;
    justify-content: center;
  }
  
  .footer .description {
    font-size: 20px;
    margin-bottom: 0px;
  color: black;
  }
  
  .footer .info {
    font-size: 16px;
    opacity: 0.8;
  }
  
  .footer .divider {
    border: none;
    border-bottom: 1px solid #fff;
    margin: 25px 0;
    opacity: 0.2;
  }
  
  .footer .sub-footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  
  .footer .sub-footer .terms,
  .footer .sub-footer .privacy,
  .footer .sub-footer .glossary {
  font-size: 17px;
    margin-left: 10px;
    text-decoration: none;
    color: black;
  }
  
  .logo img {
    width: 50px;
    height: 50px;
  }
  
  
  
  .footer-content {
    display: flex;
    justify-content: space-between;
    align-items: flex-start; /* Align items at the top */
    flex-wrap: wrap; /* Add flex-wrap property to wrap the content on smaller screens */
  }
  
  .google-play-container {
    display: flex;
    flex-direction: column; /* Arrange items in a column */
    align-items: flex-end; /* Align items to the right */
    margin-top: -20px; /* Adjust the margin-top to remove the space */
  }
  
  .google-play-container img {
    width: 182px;
    height: 70px;
  }
  
  .description,
  .info,
  .divider,
  .sub-footer {
    flex-basis: 100%;
  color: black;
  }
  
  .footer p {
    margin-bottom: 0; 
  }
  

.footer .twitter-link svg {
  width: 25px;
  height: 24px;
  fill: #444444;
}




.search-input-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    z-index: 999;
}
.search-input-container {
    position: absolute;
    top: 30%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: #ffffff;
    padding: 20px;
    border-radius: 4px;
    z-index: 1000;
    width: 410px; /* Fixed width for modal */
    box-sizing: border-box;
    box-shadow: 0 4px 32px rgba(0,0,0,0.18);
    display: flex;
    flex-direction: column;
    align-items: center;
}
#searchInputforModal {
    width: 340px;
    padding: 12px;
    border: 3px solid #e0e0e0;
    border-radius: 4px;
    font-size: 19px;
    outline: none;
    background-color: #ffffff;
    color: #333333;
}


#autocompleteBoxmodal {
    width: 360px;
    max-height: 158px;
    overflow-y: auto;
    line-height: 2;
    text-align: center !important;
}
#autocompleteBoxmodal:empty {
    margin-top: 0;
}
#autocompleteBoxmodal:not(:empty) {
    margin-top: 20px;
}

#autocompleteBoxmodal a {
    text-decoration: none;
    font-family: Arial, sans-serif;
    font-size: 16px;
    text-align: center !important;
    color: #333 !important;
    cursor: pointer;
    
}
#autocompleteBoxmodal li:hover {
    background-color: #f0f0f0;
}


#searchButtonmodal {
    padding: 8.5px;
    background-color: #0074d9;
    color: #fff;
    border: none;
    width: 34px;
    height: 34px;
    border-radius: 50%;
    cursor: pointer;
    font-size: 17px;
}

#searchInputforModal:focus {
    border-color: #3498db;
}
#searchInputforModal::placeholder {
    color: #999;
}

/* Add this to control icon size */
#searchButtonmodal iconify-icon {
  font-size: 17px;  /* Match the button's font-size */
  display: flex;
  align-items: center;
  justify-content: center;
}

.header {
  font-family: system-ui;
  padding: 20px;
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.header .logo {
  display: flex;
  align-items: center;
  margin-right: auto; /* Push logo to the left */
}

.header .logo img {
  height: 34px;
  width: auto;
  opacity: 0.84;
}

.header .logo-text {
  margin-left: 10px;
  font-size: 23px;
color: #444444;
  font-weight: 600;
}

.header .navigation {
  display: flex;
  align-items: center;
  gap: 25px; /* Reduced gap between buttons */
  position: absolute;
  left: 50%;
  transform: translateX(-50%); /* Center the navigation */
}

/* Hide navigation on small screens */


.header .button {
  padding: 0.5rem 1rem;
  text-decoration: none;
  color: #333;
  line-height: 1.6;
  border-radius: 4px;
  transition: background-color 0.2s;
  font-size: 1.1rem;  /* Added larger font size */
}


.header .button:hover {
  background-color: #f0f0f0;
  color: #2563eb;

}



/* Group search and language buttons */
.header-right {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-left: auto; /* Push buttons to the right */
}

header a {
      color: black;
      text-decoration: none;
    }





.language-switcher-container {
  position: relative;
  display: inline-block;
}

.language-button {
  background: none;
  border: none;
  cursor: pointer;
  padding: 10px;
  color: #444444;
  display: flex;
  align-items: center;
  font-size: 17px;
}

.language-button iconify-icon {
  font-size: 24px;
  opacity: 0.7;
}

.language-dropdown {
  display: none;
  position: absolute;
  top: 100%;
  right: 0;
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  padding: 10px;
  width: 200px;
  z-index: 1000;
}

.language-option {
  display: flex;
  align-items: center;
  padding: 8px 12px;
  cursor: pointer;
  border-radius: 4px;
  color: #444444;
  text-decoration: none;
}

.language-option:hover {
  background: #f5f5f5;
}

.language-option iconify-icon {
  margin-right: 10px;
  font-size: 20px;
}

.language-dropdown.show {
  display: block;
}

  /* BASIC STYLE ELEMENTS BELOW */
    
  .team-label {
    pointer-events: none;
    text-shadow: 0px 0px 2px white, 0px 0px 2px white, 0px 0px 2px white, 0px 0px 2px white;
}
  svg text.label {
      fill: #bcbcbc;
    }
  
  
  
    td.black {
      color: black !important;
    }
    td.red {
      color: red !important;
    }
    td.green {
      color: green !important;
    }
  text {
    font-family: Arial;
  }
  
  .result-color-blue {
    color: #3062FB !important;
    stroke: #3062FB;
    fill: #3062FB;
    fill-opacity: 0.02;
  }
  
  
  
  .radar-button {
    position:relative;
    left:-5px;
    align-items: center;
    background-color: #FFFFFF;
    border: 4px solid #135eb6; /* Add a border */
    border-radius: 35px;
    color: #0b57d0;
    width: 145px;
    height: 58px;
    cursor: pointer;
    font-size: 14px;
    font-family: 'Open Sans', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', sans-serif;
  
  }
  
  .radar-button:hover {
    background-color: #f0f0f0; /* Light grey background on hover */
}
.plot-button:hover {
    background-color: #f0f0f0; /* Light grey background on hover */
}
  .plot-button {
    position:relative;
    left:40px;
    top: -11px;
    align-items: center;
    background-color: #FFFFFF;
    border: 4px solid #135eb6; /* Add a border */
    border-radius: 35px;
    color: #0b57d0;
    width: 145px;
    height: 58px;
    font-size: 14px;
    cursor: pointer;
    font-family: 'Open Sans', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', sans-serif;  
  }
  
  
        
  .metrics-table th {
    background-color: #ececec;
    color: #444444;
    font-weight: bold;
    padding: 9px;
    text-align: left;
  }
  
  .metrics-table td {
    padding: 9px;
    border: 1px solid #ccc;
  }
  
  .metrics-table tr:nth-child(even) {
    background-color: #f2f2f2;
  }
  
  .metrics-table tr:hover {
    background-color: #ddd;
  }
  .metrics-table tr:first-child td {
    font-size: 20px;
  }
  
  #output a {

text-decoration: none; /* Remove underlining */

color: #3062FB; /* Set link color to purple */

}


  

#output {  

background-color: #FFFFFF; /* Background color */

padding: 15px; /* Add some padding */

border: 4px solid #c4eed1; /* Add a border */

border-radius: 12px; /* Add rounded corners */

font-size: 17px; /* Set the font size */

width: 300px;

color: #333; /* Text color */

font-family: Arial, sans-serif; /* Choose a font-family */

text-align: center; /* Center-align text */

line-height: 1.5; /* Set line height */

}

  #metrics-table a {
    text-decoration: none; /* Remove underlining */
    color: purple; /* Set link color to purple */
  }

  

  

  /* FUNCTIONAL STYLE ELEMENTS BELOW */


  
  svg:nth-of-type(1) {
  height: 485px;
}
  


.metrics-table {
    width: 520px;
    font-family:'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
    border-collapse: collapse;
  }

  
  /* Ensure the container is centered and elements are responsive */
.container {
  display: flex;
  flex-direction: column; /* Stack elements vertically */
  justify-content: center;
  align-items: center; /* Center elements horizontally */
  width: 100%; /* Allow the container to take up full width */
  margin: 0 auto; /* Center the container itself */
}

/* For rows that should have elements side by side */
.desktop-row {
  display: flex;
  justify-content: center; /* Center the row contents */
  align-items: flex-start; /* Align elements to the top, preventing height stretching */
  flex-wrap: wrap; /* Allow wrapping on smaller screens */
  width: 100%;
  margin: 20px 0;
}

.radar-wrapper {
  position: relative;
top: 20px;
}


.scatter-plot-wrapper {

position: relative;

top: 22px;

left: 42px;

}

.output {

flex: 1;

max-width: 300px;

  align-self: center; /* Ensure the element itself is centered */

text-align: center; /* Center text or content inside the div */

}

/* Limit the width of individual elements and center them */
.metric-table, .radar-wrapper, .scatter-plot-wrapper, .scatter-plot-wrapper-2 {
  flex: 1;
  min-width: 300px;
  max-width: 550px; /* Ensure no element exceeds 485px */
  margin: 0px 40px;
  align-self: center; /* Ensure the element itself is centered */
  text-align: center; /* Center text or content inside the div */
}



.scatter-plot, .scatter-plot-2 {
  max-height: 400px; /* Keep aspect ratio */
  max-width: 100%; /* Ensure it scales down on smaller screens */
}

/* Limit the width of the radar SVG */
.radar {
  width: 485px;
  height: auto; /* Keep aspect ratio */
  max-width: 100%; /* Ensure it scales down on smaller screens */
}

/* Wrapper for radar and button */
.radar-wrapper, .scatter-plot-wrapper, .scatter-plot-wrapper-2 {
  display: flex;
  flex-direction: column;
  align-items: center; /* Center the content inside the wrapper */
}

/* Ensure the buttons are centered below their respective elements */
.radar-button, .plot-button {
  text-align: center; /* Ensure the buttons are centered */
}

/* Mobile-specific layout: Stack elements vertically */
@media only screen and (max-width: 1048px) {
  .desktop-row {
    flex-direction: column; /* Stack elements vertically on smaller screens */
  }


    .metric-table, .radar-wrapper, .scatter-plot-wrapper, .scatter-plot-wrapper-2, .output {

  margin: 20px 40px;

}



.scatter-plot {
position: relative;
left: 20px;
max-height: 400px; /* Keep aspect ratio */
max-width: 115%; /* Ensure it scales down on smaller screens */
}


.scatter-plot-wrapper {
top: 12px;
left: -20px
}
.radar-wrapper {

top: 0px;
left: 10px

}
.plot-button {
    position:relative;
    left:30px;
  }
}

  

  body {
    margin: 0 auto;
  }
  
  
  body, html {
  
  background-color: #ffffff !important;
  }
  @media (max-width: 681px) {
body {
overflow-x: hidden;
overflow-y: auto;
height: 100vh;
min-height: 100vh;
max-height: 100vh;
position: relative;
}
#full-page {
 width: var(--dynamic-width);
  transform: scale(var(--dynamic-scale));
  transform-origin: top left;
  min-width: 681px;
  position: absolute;
  top: 0;
  left: 0;
overflow: hidden; /* Add this line */

}
	}
  #searchInput1 {
  display: none;
  }
  
  
  
  
  #searchButton1 {
    display: none;
  
  }
  
  

  
  #select-league {
    display: none;
  }
  
  
  #select-x,
  #select-y {
    display: none;
  }
  
  .header-row {
    color: #3a3a3a; /* Text color */
    font-size: 20px; /* Adjust the font size */
    font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    margin-bottom: 20px; /* Add some margin to separate it from the player rows */
    /* Add any other styles you want for the header row */
    border-bottom: 2px solid #3a3a3a; /* Add border with desired thickness and color */
  }

svg text
.x-label,
.y-label,
.team-label,
.player-name,
.x-axis text,
.y-axis text {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    pointer-events: none;
}

  </style>


     <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
     <script data-cfasync="false" src="https://cmp.gatekeeperconsent.com/min.js"></script>
     <script data-cfasync="false" src="https://the.gatekeeperconsent.com/cmp.min.js"></script>
       <script async src="//www.ezojs.com/ezoic/sa.min.js"></script>
     <script>
         window.ezstandalone = window.ezstandalone || {};
         ezstandalone.cmd = ezstandalone.cmd || [];
           ezstandalone.cmd.push(function () {
             ezstandalone.showAds();
         });
     </script>
</head>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-PSBMXX80EF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-PSBMXX80EF');
</script>

<body>
  <div id="full-page">
  <header class="header">
    <div class="logo">
      <a href="https://datamb.football">
          <img src="https://datamb.football/logo.png" alt="Arsenal statistics and data visuals. Arsenal compared to top 7 league teams in 2025/26. Arsenal club data profile, team radar comparison and plot chart"/></a>
      <div class="logo-text"><a href="https://datamb.football"></a></div>
    </div>
    <nav class="navigation">
      <a href="https://datamb.football/" class="button" data-i18n="header.home">Home</a>
      <a href="https://datamb.football/join" class="button" data-i18n="header.pro">Pro</a>
      <a href="https://datamb.football/guide" class="button" data-i18n="header.guide">Guide</a>
    </nav>
    <div class="header-right">
    <div class="search-container">
      <button id="searchButtonmodal"><iconify-icon icon="ion:search-outline"></iconify-icon></button>
  </div>
    <div class="language-switcher-container">
      <button class="language-button" id="languageButton">
        <iconify-icon icon="heroicons:globe-alt"></iconify-icon>
      </button>
          <div class="language-dropdown" id="languageDropdown">
        <a href="?lang=en" class="language-option"><iconify-icon icon="flag:gb-4x3"></iconify-icon>English</a>
        <a href="?lang=fr" class="language-option"><iconify-icon icon="flag:fr-4x3"></iconify-icon>Français</a>
        <a href="?lang=es" class="language-option"><iconify-icon icon="flag:es-4x3"></iconify-icon>Español</a>
        <a href="?lang=tr" class="language-option"><iconify-icon icon="flag:tr-4x3"></iconify-icon>Türkçe</a>
        <a href="?lang=de" class="language-option"><iconify-icon icon="flag:de-4x3"></iconify-icon>Deutsch</a>
        <a href="?lang=it" class="language-option"><iconify-icon icon="flag:it-4x3"></iconify-icon>Italiano</a>
        <a href="?lang=pt" class="language-option"><iconify-icon icon="flag:pt-4x3"></iconify-icon>Português</a>
        <a href="?lang=id" class="language-option"><iconify-icon icon="flag:id-4x3"></iconify-icon>Indonesia</a>
      </div>
    </div></div>
  </header>
<div class="search-input-modal" id="searchInputModal">
  <div class="search-input-container">
      <input type="text" id="searchInputforModal" data-i18n="search.placeholder" placeholder="Enter a team or player name...">
      <div id="autocompleteBoxmodal"></div>
  </div>
</div>


<script src="/modal.js"></script>

<div class="container">
  <div class="desktop-row">
    <div id="resultsTable" class="metric-table"></div>
    <div class="radar-wrapper">
      <svg class="radar"><g transform="translate(231.77,225.77)"><g class="axisWrapper">
        <g class="radar_label">
          <text class="label" data-type="Aerial%" data-idx="0" transform="translate(-60 -196.04) scale(1.3) rotate(-1.7)" data-i18n="radar.metrics.physicality">Physicality</text>
      </g>
      
      <g class="radar_label">
          <text class="label" data-type="Long%" data-idx="6" transform="matrix(0.65, -1.118, 1.118, 0.65, -188.21, -80.03) rotate(7.5)" data-i18n="radar.metrics.defending">Defending</text>
      </g>
      
      <g class="radar_label">
          <text class="label" data-type="Passes" data-idx="5" transform="matrix(-0.494, -1.209, 1.209, -0.494, -173, 107.54) rotate(3.87)" data-i18n="radar.metrics.counters">Counters</text>
      </g>
      
      <g class="radar_label">
          <text class="label" data-type="Exits" data-idx="4" transform="translate(-132.12 177.16) scale(1.3) rotate(21)" data-i18n="radar.metrics.possession">Possession</text>
      </g>
      
      <g class="radar_label">
          <text class="label" data-type="Aerial" data-idx="3" transform="translate(71.82 206.54) scale(1.3) rotate(-31)" data-i18n="radar.metrics.attacking">Attacking</text>
      </g>
      
      <g class="radar_label">
          <text class="label" data-type="Def Actions" data-idx="2" transform="translate(200.22 6.30) scale(1.3) rotate(99.11)" data-i18n="radar.metrics.goals">Goals</text>
      </g>
      
      <g class="radar_label">
          <text class="label" data-type="Shotstopping" data-idx="1" transform="translate(125.64 -163.65) scale(1.3) rotate(51.49)" data-i18n="radar.metrics.pressing">Pressing</text>
      </g>
      <circle class="blackCircle" r="190" style="fill:none; stroke:#D3D3D3; stroke-width:1;"></circle>
      <circle class="gridCircle" r="190" style="fill: rgb(16, 135, 188); fill-opacity: 0.03;"></circle>
      <circle class="gridCircle" r="160" style="fill: rgb(16, 135, 188); fill-opacity: 0.03;"></circle>
      <circle class="gridCircle" r="120" style="fill: rgb(16, 135, 188); fill-opacity: 0.03;"></circle>
      <circle class="gridCircle" r="80" style="fill: rgb(16, 135, 188); fill-opacity: 0.03;"></circle>
      <circle class="gridCircle" r="40" style="fill: rgb(16, 135, 188); fill-opacity: 0.03;"></circle>
      <line x1="0" y1="0" x2="9.33" y2="189.4543362" stroke="#D3D3D3" stroke-width="1" transform="translate(-9.33, -189.4543362)"></line>
      <line x1="0" y1="0" x2="-142.0538533333333" y2="126.24" stroke="#D3D3D3" stroke-width="1" transform="translate(141.74184, -126.24)"></line>
      <line x1="0" y1="0" x2="-187.31589333333332" y2="-32.31413333333333" stroke="#D3D3D3" stroke-width="1" transform="translate(187.5574112, 32.2528)"></line>
      <line x1="0" y1="0" x2="-91.84497333333333" y2="-166.92245333333333" stroke="#D3D3D3" stroke-width="1" transform="translate(91.84497333333333, 166.21328)"></line>
      <line x1="0" y1="0" x2="72.99733333333333" y2="-175.84917333333335" stroke="#D3D3D3" stroke-width="1" transform="translate(-72.99997333333334, 175.334068)"></line>
      <line x1="0" y1="0" x2="182.73258666666666" y2="-52.67472" stroke="#D3D3D3" stroke-width="1" transform="translate(-182.7209384, 52.480128)"></line>
      <line x1="0" y1="0" x2="154.67849333333334" y2="109.91788799999999" stroke="#D3D3D3" stroke-width="1" transform="translate(-154.6883792222, -110.017215488)"></line>
      <g class="radarWrapper"></g>
      </g></g></svg>      <a href="https://datamb.football/teamradars/">
        <button class="radar-button" data-i18n="teams.radar.compare">Compare teams</button>
      </a>
    </div>
  </div>

  <!-- Second row: Output and scatter plot with plot-button -->
  <div class="desktop-row">
    <div id="output" class="output"></div>

    <!-- Wrapper for scatter plot and button -->
    <div class="scatter-plot-wrapper">
      <svg id="scatter-plot" class="scatter-plot"></svg>
      <a href="https://datamb.football/plotteam/">
        <button class="plot-button" data-i18n="plot.more">Plot more metrics</button>
      </a>
    </div>
  </div>
</div>


        

<input id="search-bar" style="display: none;">
<select id="select-league" style="display: none;"><option value="all"></option></select>
<select id="select-age" style="display: none;"><option value="all"></option></select>
<select id="select-x" style="display: none;"></select>
<select id="select-y" style="display: none;"></select>                   
<select id="select-size" style="display: none;"></select>

  
<input type="text" id="searchInput1" class="search-bar" placeholder=""/>
<input type="button" id="searchButton1" value=""/>



<script>
  
  
  const csvData = '1,Arsenal,vs Top 7 League teams,2025/26,Premier League,0.824,0.865,0.856,0.847,0.977,0.721,0.786';  



        const dataArray = csvData.split('\n').map(line => line.split(','));
      // Make dataArray globally accessible for plot code
      window.dataArray = dataArray;

  const colorClasses = ['result-color-blue'];
  
  let searchResults = []; // Declare the search results variable
  
  
  function removeSpecialChars(str) {
    return str.normalize('NFD').replace(/[\u0300-\u036f\s]/g, '');
  }
  
  function search(query) {
    const results = dataArray.filter(data =>
      removeSpecialChars(data[1].toLowerCase()).includes(removeSpecialChars(query.toLowerCase()))
    );
    return results;
  }
  
  function createTable(teamName, teamIndex, color) {
    const resultsTable = document.getElementById('resultsTable');
    const headerNames = [
      '',
      '',
      '',
      'Season',
      'League',
      'Goals',
      'Attacking',
      'Possession',
      'Counters',
      'Defending',
      'Physicality',
      'Pressing'
          ];

    // Translation keys for header names
    const headerTranslationKeys = [
      '',
      '',
      '',
      'table.season',
      'table.league',
      'table.metrics.goals',
      'table.metrics.attacking',
      'table.metrics.possession',
      'table.metrics.counters',
      'table.metrics.defending',
      'table.metrics.physicality',
      'table.metrics.pressing'
    ];
    
  
    // Check if table headers exist
    const headersExist = resultsTable.querySelector('th') !== null;
  
    const table = headersExist ? resultsTable.querySelector('table') : document.createElement('table');
    table.classList.add('metrics-table');
  
    if (!headersExist) {
          // Create the table header
          const headerRow = document.createElement('tr');
          for (let i = 0; i < headerNames.length; i++) {
            const th = document.createElement('th');
            if (headerTranslationKeys[i]) {
              th.setAttribute('data-i18n', headerTranslationKeys[i]);
            }
            th.textContent = headerNames[i];
            headerRow.appendChild(th);
          }
        }
  
    const teamData = dataArray[teamIndex];
    for (let i = 1; i < headerNames.length; i++) {
      const dataRow = document.createElement('tr');
      const td1 = document.createElement('td');
          
          // Add data-i18n attribute to the first cell in each row
          if (headerTranslationKeys[i]) {
            td1.setAttribute('data-i18n', headerTranslationKeys[i]);
          }
          td1.textContent = headerNames[i];
      dataRow.appendChild(td1);
      
      const td2 = document.createElement('td');
      let value = teamData[i];
    
        if (i === 2) {
          const vsSpan = document.createElement('span');
          vsSpan.setAttribute('data-i18n', 'table.vs_top_7_leagues');
          vsSpan.textContent = "vs Top 7 Leagues";
          td2.appendChild(vsSpan);
          value = '';
        } else if (i >= 5 && i <= 11) {
          value = parseFloat(value) * 100;
          const roundedValue = Math.round(value);
          const lastDigit = roundedValue % 10;
          let percentileSuffix = 'th';
          if (lastDigit === 1 && roundedValue !== 11) {
            percentileSuffix = 'st';
          } else if (lastDigit === 2 && roundedValue !== 12) {
            percentileSuffix = 'nd';
          } else if (lastDigit === 3 && roundedValue !== 13) {
            percentileSuffix = 'rd';
          }
                        // Store the numeric value separately
              const numericValue = roundedValue;
              
              // Create a span for the percentile suffix to make it translatable
              const valueSpan = document.createElement('span');
              valueSpan.textContent = numericValue;
              
const suffixSpan = document.createElement('span');
              if (percentileSuffix === 'th') {
                suffixSpan.setAttribute('data-i18n', 'table.percentile_suffix.th_suffix');
              } else if (percentileSuffix === 'st') {
                suffixSpan.setAttribute('data-i18n', 'table.percentile_suffix.st_suffix');
              } else if (percentileSuffix === 'nd') {
                suffixSpan.setAttribute('data-i18n', 'table.percentile_suffix.nd_suffix');
              } else if (percentileSuffix === 'rd') {
                suffixSpan.setAttribute('data-i18n', 'table.percentile_suffix.rd_suffix');
              }
              suffixSpan.textContent = percentileSuffix;
              
              
              const percentileSpan = document.createElement('span');
              percentileSpan.setAttribute('data-i18n', 'table.percentile');
              percentileSpan.textContent = ' percentile';
              
              td2.appendChild(valueSpan);
              td2.appendChild(suffixSpan);
              td2.appendChild(percentileSpan);
              
              // Set empty text content since we're using child nodes
              value = '';
        }
    
        if ([1, 2, 3, 4].includes(i)) {
          td2.classList.add('black'); // Add the black class
        }
        
        if (value !== '') {
          td2.textContent = value;
        }
        td2.classList.add(color);
    
        // Apply color based on value range
              // Apply color based on value range
              let numericValue;
              if (value === '') {
                // If we've already processed this cell with spans
                numericValue = parseInt(td2.firstChild.textContent);
              } else {
                numericValue = parseFloat(value);
              }
              
              if (numericValue >= 75 && numericValue <= 100) {
                td2.classList.add('green');
              } else if (numericValue >= 0 && numericValue <= 25) {
                td2.classList.add('red');
              }
            
          
        
          dataRow.appendChild(td2);
          table.appendChild(dataRow);
        }
if (!headersExist) {
  resultsTable.appendChild(table);
}
  
    const combResults = dataArray[teamIndex].join(', ');
    console.log(combResults);
  
    const outerRadius = 190;
    const center = [0, 0];
    const angles = [
      0,
      (2 * Math.PI) / 7,
      (4 * Math.PI) / 7,
      (6 * Math.PI) / 7,
      (8 * Math.PI) / 7,
      (10 * Math.PI) / 7,
      (12 * Math.PI) / 7
    ];
  
    function axisValueToCartesian(axis, value) {
      let angle = angles[axis - 1];
      angle += (2 * Math.PI / 7) * 0.2;
      const x = 190 * value * Math.cos(angle);
      const y = 190 * value * Math.sin(angle);
      return { x, y };
    }
  
    const svg = document.querySelector('.radar');
    const radarWrapper = svg.appendChild(
      document.createElementNS('http://www.w3.org/2000/svg', 'g')
    );
    radarWrapper.setAttribute('transform', 'translate(231.77,225.77)');
    radarWrapper.innerHTML = '';
  
    const data = [];
    const rowCols = combResults.split(',');
    for (let i = 5; i < 12; i++) {
      data.push({ axis: i - 4, value: parseFloat(rowCols[i]) });
    }
  
    const points = data
      .map(({ axis, value }) => {
        const { x, y } = axisValueToCartesian(axis, value);
        return `${x},${y}`;
      })
      .join(' ');
  
    const polyline = document.createElementNS(
      'http://www.w3.org/2000/svg',
      'polyline'
    );
    polyline.setAttribute('class', `radarLines ${color}`);
    polyline.setAttribute('points', `${points} ${points.split(' ')[0]}`);
    polyline.setAttribute('stroke-width', '3');
    polyline.setAttribute('fill', 'none');
    radarWrapper.appendChild(polyline);
  
    const polygon = document.createElementNS(
      'http://www.w3.org/2000/svg',
      'polygon'
    );
    polygon.setAttribute('class', `radarPolygon ${color}`);
    polygon.setAttribute('points', points);
    polygon.style.fillOpacity = '0.2';
    radarWrapper.appendChild(polygon);
  
    data.forEach(({ axis, value }) => {
      const { x, y } = axisValueToCartesian(axis, value);
      const circle = document.createElementNS(
        'http://www.w3.org/2000/svg',
        'circle'
      );
      circle.setAttribute('class', `radarCircle ${color}`);
      circle.style.fillOpacity = '0.86';
      circle.setAttribute('r', '6');
      circle.setAttribute('cx', x);
      circle.setAttribute('cy', y);
      radarWrapper.appendChild(circle);
    });
  }
  
  
  
  function toggleFilling() {
    const radarPolygons = document.querySelectorAll('.radarPolygon');
    radarPolygons.forEach(polygon => {
      polygon.style.fill = polygon.style.fill ? '' : 'none'; // Toggle the filling
    });
  }
  
  
    const teamNames = new Set();
  
  
  function createTableForTeam1() {
    const searchInput1 = document.getElementById('searchInput1');
    const searchButton1 = document.getElementById('searchButton1');
    const resultsTable = document.getElementById('resultsTable');
    const teamNamesList = document.createElement('ul');
    teamNamesList.style.fontFamily = 'Arial, sans-serif';
    teamNamesList.style.listStyleType = 'none';
    teamNamesList.style.paddingLeft = '9px';
    resultsTable.appendChild(teamNamesList);
    let searchCounter = 0;
  
    searchButton1.addEventListener('click', function () {
      const searchQuery = searchInput1.value;
      const results = search(searchQuery);
  
      // Reset the toggle state before performing a new search
      const radarPolygons = document.querySelectorAll('.radarPolygon');
      radarPolygons.forEach(polygon => {
        polygon.style.fill = '';
      });
  
      if (results) {
        const teamId = parseInt(results[0]);
        const teamName =
          results[1] + ' (' + results[2] + ', ' + results[3] + ') - ' + results[11] + ' min';
        const color = colorClasses[searchCounter % colorClasses.length];
  
        createTable(teamName, teamId - 1, color);
  
        searchCounter++;
      }
    });
  }
  
  createTableForTeam1();
  searchButton1.click(); // Trigger the search button click event

  
</script>

<script>


  // Your special characters dictionary and translation table
  const special_characters = {
      'á': 'a', 'à': 'a', 'â': 'a', 'ä': 'a', 'å': 'a',
      'é': 'e', 'è': 'e', 'ê': 'e', 'ë': 'e',
      'í': 'i', 'ì': 'i', 'î': 'i', 'ï': 'i',
      'ó': 'o', 'ò': 'o', 'ô': 'o', 'ö': 'o', 'ø': 'o',
      'ú': 'u', 'ù': 'u', 'û': 'u', 'ü': 'u',
      'ç': 'c', 'ñ': 'n',
      'ß': 'ss', 'æ': 'ae', 'œ': 'oe'
      // Add other special characters and their replacements here
  };

  // Create a translation table using the special_characters dictionary
  const translation_table = new Map(Object.entries(special_characters));

  function clean_and_replace(text) {
    // Remove leading/trailing spaces
    text = text.trim();
  
    // Replace known special characters with their corresponding values from the translation table
    text = text.replace(/[áàâäåéèêëíìîïóòôöøúùûüçñßæœ]/g, (match) => translation_table.get(match) || '_');
  
    // Replace spaces and other non-alphanumeric characters with underscores
    text = text.replace(/[^a-zA-Z0-9]+/g, '_');
  
    return text;
  }

  // Function to check if player name has a number suffix and extract it
  function extractPlayerNumber(playerName) {
      const match = playerName.match(/(\d+)$/);
      return match ? match[1] : null;
  }

  // Function to get display name (without number) and URL suffix
  function getPlayerDisplayInfo(playerName) {
      const number = extractPlayerNumber(playerName);
      if (number) {
          // Remove the number from the display name
          const displayName = playerName.replace(/\d+$/, '');
          return {
              displayName: displayName,
              urlSuffix: number
          };
      } else {
          return {
              displayName: playerName,
              urlSuffix: null
          };
      }
  }

  // Function to generate the link based on player's name and position
  function generatePlayerLink(player) {
      const playerInfo = getPlayerDisplayInfo(player[0]);
      const cleanedName = clean_and_replace(playerInfo.displayName);
      const cleanedPosition = clean_and_replace(player[1]);
      
      let url = `https://datamb.football/${cleanedName}_${player[1]}_stats/`;
      
      // Add number suffix to URL if player has a number
      if (playerInfo.urlSuffix) {
          url = url.replace('_stats/', `_stats${playerInfo.urlSuffix}/`);
      }
      
      return url;
  }

  function filterPlayers() {
    const selectedTeam = 'Arsenal'; // Change to the desired team
    const xhr = new XMLHttpRequest();
    const encoded = 'aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL29obGl0bXliYWQvb2hsaXRteWJhZC5naXRodWIuaW8vbWFpbi9kYXRhYmFzZS9wbGF5ZXJmb3J0ZWFtLmNzdg==';
    xhr.open('GET', atob(encoded), false);
    xhr.send(null);
    
    let csv = xhr.responseText;



      Papa.parse(csv, {
        header: false,
        skipEmptyLines: true,
        dynamicTyping: true,
        complete: function (results) {
            const data = results.data.slice(1); // Skip the header row
    
            const teamPlayers = data.filter(player => player[2] === selectedTeam);
    
            const uniquePlayersMap = new Map();
            teamPlayers.forEach(player => {
                if (!uniquePlayersMap.has(player[0])) {
                    uniquePlayersMap.set(player[0], player);
                } else {
                    // If a duplicate is found, we'll choose one player at random
                    const existingPlayer = uniquePlayersMap.get(player[0]);
                    if (Math.random() < 0.5) {
                        uniquePlayersMap.set(player[0], player);
                    }
                }
            });
    
            const uniquePlayers = Array.from(uniquePlayersMap.values());
    
            uniquePlayers.sort((a, b) => b[3] - a[3]);
    
            const outputDiv = document.getElementById('output');
            outputDiv.innerHTML = '';
    
            // Create the header row
            const headerDiv = document.createElement('div');
            headerDiv.textContent = 'MOST LEAGUE MINUTES';
            headerDiv.setAttribute('data-i18n', 'teams.minutes');
            headerDiv.classList.add('header-row'); // Add the CSS class
            outputDiv.appendChild(headerDiv);
            
    
            uniquePlayers.forEach(player => {
                const playerDiv = document.createElement('div');
                const nameLink = document.createElement('a');
                nameLink.href = generatePlayerLink(player); // Generate the player link
                
                // Get display name (without number if present)
                const playerInfo = getPlayerDisplayInfo(player[0]);
                nameLink.textContent = playerInfo.displayName;
                const positionLink = document.createElement('a');
                positionLink.textContent = player[1];
                
                // Add data-i18n attribute based on position
                if (player[1] === 'Goalkeeper') {
                    positionLink.href = 'https://datamb.football/keepers';
                    positionLink.setAttribute('data-i18n', 'positions.goalkeeper');
                } else if (player[1] === 'Centre-back') {
                    positionLink.href = 'https://datamb.football/centrebacks';
                    positionLink.setAttribute('data-i18n', 'positions.centreback');
                } else if (player[1] === 'Full-back') {
                    positionLink.href = 'https://datamb.football/fullbacks';
                    positionLink.setAttribute('data-i18n', 'positions.fullback');
                } else if (player[1] === 'Midfielder') {
                    positionLink.href = 'https://datamb.football/midfielders';
                    positionLink.setAttribute('data-i18n', 'positions.midfielder');
                } else if (player[1] === 'Winger') {
                    positionLink.href = 'https://datamb.football/wingers';
                    positionLink.setAttribute('data-i18n', 'positions.winger');
                } else if (player[1] === 'Striker') {
                    positionLink.href = 'https://datamb.football/strikers';
                    positionLink.setAttribute('data-i18n', 'positions.striker');
                }
                playerDiv.appendChild(nameLink);
                playerDiv.appendChild(document.createTextNode(', '));
                playerDiv.appendChild(positionLink);
                playerDiv.appendChild(document.createTextNode(`, ${player[3]}`));
                outputDiv.appendChild(playerDiv);
            });
        }
    });       }

  // Automatically call filterPlayers when the page loads
  filterPlayers();   
  
</script>




<script>

// Load the data asynchronously
const WORKER_URL = 'https://summer-dream-8f33.datamb-football.workers.dev';

(async function() {
const response = await fetch(`${WORKER_URL}/?file=3`); // 3 = teamplots.csv
let csvData2 = await response.text();

let extraHeaderRow = 'ID,Player,Top 7 Leagues,Goals per 90,xG per 90,Shots on target per 90,Shots on target %,Passes completed,Pass accuracy %,Possession %,Positional attacks per 90,Counter attacks per 90,Touches in the box per 90,Goals conceded per 90,SoT against per 90,Defensive duels per 90,Defensive duel %,Aerial duels per 90,Aerial duels %,Passes per possession,PPDA\n';

// Concatenate the extra header row with the fetched CSV data
csvData2 = extraHeaderRow + csvData2;

var rows = csvData2.trim().split('\n');
var header = rows[0].split(',');
var data = rows.slice(1).map(function(row) {
    return row.split(',').map(function(d, i) {
        if (i >= 3) {
            return parseFloat(d);
        } else {
            return d;
        }
    });
});

var margin = { top: 0, right: 0, bottom: 0, left: 0 };
var width = 1082 - margin.left - margin.right;
var height = 770 - margin.top - margin.bottom;

// Define league colors for clicked circles
var leagueColors = {
    "Premier League": "rgb(255, 0, 0, 0.7)",         // 1
    "La Liga": "rgb(255, 223, 0, 0.7)",             // 2
    "Bundesliga": "rgb(85, 209, 73, 0.7)",          // 3
    "Serie A": "rgb(0, 191, 255, 0.7)",             // 4
    "Ligue 1": "rgb(153, 50, 204, 0.7)",            // 5
    "Eredivisie": "rgb(255, 140, 0, 0.7)",          // 6
    "Primeira Liga": "rgb(255, 20, 147, 0.7)",      // 7
};


// Function to get color based on league
function getLeagueColor(league) {
    return leagueColors[league] || "rgba(255, 0, 0, 0.7)"; // Default to red if league not found
}

var margin = { top: 40, right: 80, bottom: 100, left: 100 };
 var width = 620 - margin.left - margin.right;
 var height = 415 - margin.top - margin.bottom;



var medianLinesVisible = true;

var selectX = d3.select("#select-x");
var selectY = d3.select("#select-y");

var names = data.map(function(row) {
    return row[1];
});

// Populate the select dropdowns
header.slice(3).forEach(function(metric) {
    selectX.append("option")
        .text(metric)
        .attr("value", metric);
    selectY.append("option")
        .text(metric)
        .attr("value", metric);

});

// Set default values for the selectors
selectX.property("value", header[3]);
selectY.property("value", header[13]);

// Create the SVG container
var svg = d3.select("#scatter-plot")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");



var xScale = d3.scaleLinear()
    .range([0, width]);
var yScale = d3.scaleLinear()
    .range([height, 0]);


var xAxis = d3.axisBottom(xScale).tickSize(0);
var yAxis = d3.axisLeft(yScale).tickSize(0);

// Add X axis
var gXAxis = svg.append("g")
    .attr("class", "x-axis")
    .attr("transform", "translate(0," + height + ")");

// Add Y axis
var gYAxis = svg.append("g")
    .attr("class", "y-axis");

// Add axis labels
var xLabel = svg.append("text")
    .attr("class", "x-label")
    .attr("text-anchor", "end")
    .attr("x", width)
    .attr("y", height + 35)
    .style("font-family", "Inter, sans-serif")
    .style("font-size", "14px");

var yLabel = svg.append("text")
    .attr("class", "y-label")
    .attr("text-anchor", "end")
    .attr("transform", "rotate(-90)")
    .attr("y", -53)
    .attr("x", 0)
    .style("font-family", "Inter, sans-serif")
    .style("font-size", "14px");



var clickedCircles = [];
var filteredData = data;
var filteredNames = names;
var circles;

updateChart = function() {
    d3.select("#scatter-plot")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom);
        
    // Update axis positions based on new dimensions
    gXAxis.attr("transform", "translate(0," + height + ")");
    xLabel.attr("x", width)
          .attr("y", height + 35);
    yLabel.attr("x", 0);
    
    // Check if dark mode is active
    const isDarkMode = document.body.classList.contains('dark-mode');
    
    // Get the selected league
    var selectedLeague = document.getElementById("select-league").value;
    
    // Get the selected age
    var selectedAge = document.getElementById("select-age").value;
    
    // Filter data based on selected league
        filteredData = data;


    
    // Update filtered names
    filteredNames = filteredData.map(function(d) {
        return d[1];
    });
    
    // Get the selected metrics
    xMetric = selectX.property("value");
    yMetric = selectY.property("value");
    
    // Update scales with consistent 10% padding on each side
    xScale.range([0, width])
.domain(function() {
  // Get the raw extent
  const extent = d3.extent(filteredData, function(d) { 
      return +d[header.indexOf(xMetric)]; 
  });
  
  // Apply nice() to get rounded values
  const niceScale = d3.scaleLinear().domain(extent).nice();
  const niceExtent = niceScale.domain();
  
  // Calculate the original range and the nice range
  const originalRange = extent[1] - extent[0];
  const niceRange = niceExtent[1] - niceExtent[0];
  
  // Check if nice() added more than 10% padding
  if ((niceRange / originalRange) > 1.2) { // 1.2 represents original + 20% (10% on each side)
      // If so, use manual 10% padding instead
      const padding = originalRange * 0.1;
      return [extent[0] - padding, extent[1] + padding];
  } else {
      // Otherwise use the nice rounded values
      return niceExtent;
  }
}());


          yScale.range([height, 0])
.domain(function() {
  // Get the raw extent
  const extent = d3.extent(filteredData, function(d) { 
      return +d[header.indexOf(yMetric)]; 
  });
  
  // Apply nice() to get rounded values
  const niceScale = d3.scaleLinear().domain(extent).nice();
  const niceExtent = niceScale.domain();
  
  // Calculate the original range and the nice range
  const originalRange = extent[1] - extent[0];
  const niceRange = niceExtent[1] - niceExtent[0];
  
  // Check if nice() added more than 10% padding
  if ((niceRange / originalRange) > 1.2) { // 1.2 represents original + 20% (10% on each side)
      // If so, use manual 10% padding instead
      const padding = originalRange * 0.1;
      return [extent[0] - padding, extent[1] + padding];
  } else {
      // Otherwise use the nice rounded values
      return niceExtent;
  }
}());

  

    
    // Update axes
    gXAxis.call(d3.axisBottom(xScale).tickSize(0));
    gYAxis.call(d3.axisLeft(yScale).tickSize(0));
    
    // Create metric key for translation
    const xMetricKey = "metrics." + xMetric.toLowerCase().replace(/ /g, '-').replace(/%/g, 'pct');
    const yMetricKey = "metrics." + yMetric.toLowerCase().replace(/ /g, '-').replace(/%/g, 'pct');
    
    // Set data-i18n attribute
    xLabel.attr("data-i18n", xMetricKey);
    yLabel.attr("data-i18n", yMetricKey);
    
    // Apply translations directly if available
    if (window.currentTranslations && window.currentTranslations.metrics) {
        const xTranslationKey = xMetric.toLowerCase().replace(/ /g, '-').replace(/%/g, 'pct');
        const yTranslationKey = yMetric.toLowerCase().replace(/ /g, '-').replace(/%/g, 'pct');
        
        const xTranslation = window.currentTranslations.metrics[xTranslationKey];
        const yTranslation = window.currentTranslations.metrics[yTranslationKey];
        
        xLabel.text(xTranslation || xMetric);
        yLabel.text(yTranslation || yMetric);
    } else {
        xLabel.text(xMetric);
        yLabel.text(yMetric);
    }

    // Remove existing circles and labels
    svg.selectAll("circle").remove();
    svg.selectAll(".team-label").remove();
    svg.selectAll(".xy-line").remove(); // Remove any existing diagonal reference line
    svg.selectAll(".xy-line-bg").remove(); // Remove line background
    svg.selectAll(".xy-line-label").remove(); // Remove line label
    svg.selectAll(".xy-line-label-bg").remove(); // Remove label background
    svg.selectAll(".performance-label").remove(); // Remove performance labels
    svg.selectAll("linearGradient#line-gradient").remove(); // Remove gradient definition
    svg.selectAll("marker#arrow-over, marker#arrow-under").remove(); // Remove arrow markers
    svg.selectAll(".xy-line-hover").remove(); // Remove hover detection element
    svg.selectAll(".median-line").remove(); // Always remove median lines before potentially redrawing them
    
    // Add diagonal reference line for xG vs Goals
    if ((xMetric === 'xG per 90' && yMetric === 'Goals per 90') || 
        (xMetric === 'Goals per 90' && yMetric === 'xG per 90') ||
        (xMetric === 'Non-penalty goals per 90' && yMetric === 'npxG per 90') ||
        (xMetric === 'npxG per 90' && yMetric === 'Non-penalty goals per 90') ||
        (xMetric === 'Assists per 90' && yMetric === 'xA per 90') ||
        (xMetric === 'xA per 90' && yMetric === 'Assists per 90') ||
        (xMetric === 'NPG+A per 90' && yMetric === 'npxG+xA per 90') ||
        (xMetric === 'npxG+xA per 90' && yMetric === 'NPG+A per 90') ||
        (xMetric === 'xG conceded per 90' && yMetric === 'Goals conceded per 90') ||
        (xMetric === 'Goals conceded per 90' && yMetric === 'xG conceded per 90') ||
        (xMetric === 'xG conceded' && yMetric === 'Goals conceded') ||
        (xMetric === 'Goals conceded' && yMetric === 'xG conceded')) 
        
        {
        
        // Variable to track hover timer for the diagonal line
        var diagonalLineHoverTimer = null;
        
        // Calculate the intersection points for the x=y line
        var minX = d3.min(filteredData, function(d) { return d[header.indexOf(xMetric)]; });
        var maxX = d3.max(filteredData, function(d) { return d[header.indexOf(xMetric)]; });
        var minY = d3.min(filteredData, function(d) { return d[header.indexOf(yMetric)]; });
        var maxY = d3.max(filteredData, function(d) { return d[header.indexOf(yMetric)]; });
        
        // Get the smaller max between the x and y axes
        var maxVal = Math.min(maxX, maxY);
        
        // Get the larger min between the x and y axes
        var minVal = Math.max(minX, minY);
        
        // Now draw the line only within these bounds
        svg.append("line")
            .attr("class", "xy-line")
            .attr("x1", xScale(minVal))
            .attr("y1", yScale(minVal))
            .attr("x2", xScale(maxVal))
            .attr("y2", yScale(maxVal))
            .style("stroke", "#2ecc71") // Simple green color
            .style("stroke-width", "2")
            .style("stroke-dasharray", "5,3");
        
        // Add invisible wider line for better hover detection
        svg.append("line")
            .attr("class", "xy-line-hover")
            .attr("x1", xScale(minVal))
            .attr("y1", yScale(minVal))
            .attr("x2", xScale(maxVal))
            .attr("y2", yScale(maxVal))
            .style("stroke", "transparent")
            .style("stroke-width", "15")
            .style("cursor", "help")
            .on("mouseover", function() {
                // Clear any existing timer
                if (diagonalLineHoverTimer) {
                    clearTimeout(diagonalLineHoverTimer);
                }
                
                // Capture the event coordinates
                var eventX = d3.event.pageX;
                var eventY = d3.event.pageY;
                
            })
      
    }
    
    // Add median lines if enabled
    if (medianLinesVisible) {
        // Calculate medians
        var xMedian = d3.median(filteredData, function(d) { 
            return d[header.indexOf(xMetric)]; 
        });
        
        var yMedian = d3.median(filteredData, function(d) { 
            return d[header.indexOf(yMetric)]; 
        });
        
        // Add X median line
        svg.append("line")
            .attr("class", "median-line")
            .attr("x1", xScale(xMedian))
            .attr("y1", 0)
            .attr("x2", xScale(xMedian))
            .attr("y2", height)
            .style("stroke", "rgba(0, 0, 0, 0.3)")
            .style("stroke-dasharray", "4");
        
        // Add Y median line
        svg.append("line")
            .attr("class", "median-line")
            .attr("x1", 0)
            .attr("y1", yScale(yMedian))
            .attr("x2", width)
            .attr("y2", yScale(yMedian))
            .style("stroke", "rgba(0, 0, 0, 0.3)")
            .style("stroke-dasharray", "4");
    }
    
    // Add circles
    circles = svg.selectAll("circle")
        .data(filteredData)
        .enter()
        .append("circle")
        .attr("cx", function(d) { return xScale(d[header.indexOf(xMetric)]); })
        .attr("cy", function(d) { return yScale(d[header.indexOf(yMetric)]); })
        .attr("r", 8)
        .style("fill", function(d) {
            // Check if this circle is in the clicked circles array
            if (clickedCircles.includes(d[1])) {
                return getLeagueColor(d[2]);
            }
            return "rgba(70, 130, 180, 0.7)";
        })
        .style("stroke", function(d) {
            return clickedCircles.includes(d[1]) ? "#000" : "none";
        })
        .style("stroke-width", function(d) {
            return clickedCircles.includes(d[1]) ? 2 : 0;
        })
    
        
    // Add labels for clicked teams
    clickedCircles.forEach(function(teamName) {
        var teamData = filteredData.find(function(d) {
            return d[1] === teamName;
        });
        
        if (teamData) {
            addTeamLabel(teamData, false);
        }
    });

    

        const playerData = filteredData.find(d => d[1] === "Arsenal");

                svg.selectAll("circle").filter(function(d) {
                    return d[1] === "Arsenal";
                })
                .style("fill", function(d) {
                    return getLeagueColor(d[2]);
                })
                .style("stroke", "#000")
                .style("stroke-width", 2)
                .style("cursor", "default") // Set cursor to default after click
                .each(function() {
                    // Bring Tielemans circle to front
                    this.parentNode.appendChild(this);
                });
                
                // Add team label
                addTeamLabel(playerData, false);
  
            
        
        
        // Set flag to true so we don't try to click Bruno again
        initialClickPerformed = true;
    
}



// Function to remove special characters and diacritics for better search matching
function removeSpecialCharsAndDiacritics(str) {
    if (!str) return '';
    return str.normalize('NFD')
        .replace(/[\u0300-\u036f]/g, '') // Remove diacritics
        .replace(/Ø/g, 'O')
        .replace(/ø/g, 'o');
}

// Add search functionality
var searchBar = document.getElementById("search-bar");

searchBar.addEventListener("input", function() {
    var searchTerm = searchBar.value.toLowerCase();
    
    if (searchTerm === '') {
        resetSearch();
        return;
    }
    
    // Normalize search term to handle special characters and diacritics
    var normalizedSearchTerm = removeSpecialCharsAndDiacritics(searchTerm);
    
    // Reset previous search styling
    svg.selectAll("circle").classed("search-match", false)
        .style("fill", function(d) {
            // Restore original fill color
            return clickedCircles.includes(d[1]) ? getLeagueColor(d[2]) : "rgba(70, 130, 180, 0.7)";
        })
        .style("stroke", function(d) {
            return clickedCircles.includes(d[1]) ? "#000" : "none";
        })
        .style("stroke-width", function(d) {
            return clickedCircles.includes(d[1]) ? 2 : 0;
        })
        .style("filter", "none")
        .each(function() {
            // Reset any inline styles that might interfere with our animation
            d3.select(this).style("r", null);
        });
    
    svg.selectAll(".team-label")
        .classed("search-match", false)
        .classed("search-dimmed", false);
    
    // Find matching teams
    var matchingTeams = [];
    
    // Apply new search styling
    svg.selectAll("circle").filter(function(d) {
        var teamName = d[1].toLowerCase();
        var normalizedTeamName = removeSpecialCharsAndDiacritics(teamName);
        
        // Check both original and normalized versions for better matching
        var isMatch = teamName.includes(searchTerm) || normalizedTeamName.includes(normalizedSearchTerm);
        
        if (isMatch) {
            matchingTeams.push(d[1]);
        }
        
        return isMatch;
    })
    .classed("search-match", true)
    .each(function() {
        // Bring matching circles to front
        this.parentNode.appendChild(this);
    });
    
    // If we have matches, dim non-matching labels
    if (matchingTeams.length > 0) {
        // First dim all labels
        svg.selectAll(".team-label").classed("search-dimmed", true);
        
        // Then highlight matching labels
        svg.selectAll(".team-label").filter(function() {
            var labelText = d3.select(this).text();
            return matchingTeams.includes(labelText);
        })
        .classed("search-match", true)
        .classed("search-dimmed", false)
        .each(function() {
            // Bring matching labels to front
            this.parentNode.appendChild(this);
        });
        
        // Add labels for matching teams that don't have labels yet
        matchingTeams.forEach(function(teamName) {
            // Check if this team already has a label
            var labelClass = "team-label-" + teamName.toLowerCase()
        .replace(/[^a-z0-9]/g, '-') // Replace any non-alphanumeric character with a hyphen
        .replace(/-+/g, '-')        // Replace multiple consecutive hyphens with a single one
        .replace(/^-|-$/g, '');     // Remove leading and trailing hyphens
    

            if (svg.select("." + labelClass).size() === 0) {
                // Find the team data
                var teamData = filteredData.find(function(d) {
                    return d[1] === teamName;
                });
                
                if (teamData) {
                    // Add the label with isSearchMatch=true to bypass collision detection
                    addTeamLabel(teamData, true);
                    // Apply search match styling (now done inside addTeamLabel)
                }
            }
        });
    } 
});



updateChart();



function addTeamLabel(d, isSearchMatch) {
    var x = xScale(d[header.indexOf(xMetric)]);
    var y = yScale(d[header.indexOf(yMetric)]);
    
    // Create a unique class name for this team's label
    var teamClass = "team-label-" + d[1].toLowerCase()
        .replace(/[^a-z0-9]/g, '-') // Replace any non-alphanumeric character with a hyphen
        .replace(/-+/g, '-')        // Replace multiple consecutive hyphens with a single one
        .replace(/^-|-$/g, '');     // Remove leading and trailing hyphens
    
    // Check if this label already exists (avoid duplicates)
    if (svg.select("." + teamClass).size() > 0) {
        return;
    }
    
    // Create the label temporarily to measure its width
    var tempLabel = svg.append("text")
        .attr("class", "temp-label")
        .text(d[1])
        .style("font-family", "Inter, sans-serif")
        .style("font-size", "12px")
        .style("opacity", 0);
    
    var labelWidth = tempLabel.node().getComputedTextLength();
    tempLabel.remove();
    
    // Get chart boundaries
    var chartWidth = width;
    var chartHeight = height;
    
    var labelX = x + 18;
    var labelY = y;
    var anchor = "start";
    
    if (labelX + labelWidth > chartWidth) {
        // Place to the left instead
        labelX = x - 14;
        anchor = "end";
    }
    
    var label = svg.append("text")
        .attr("class", "team-label " + teamClass)
        .attr("x", labelX)
        .attr("y", labelY)
        .attr("text-anchor", anchor)
        .attr("dominant-baseline", "middle")
        .text(d[1])
        .style("font-family", "Inter, sans-serif")
        .style("font-size", "12px")
        .style("font-weight", "500")
        .style("fill", "#333");
}

})(); // End async IIFE

</script>

<div id="ezoic-pub-ad-placeholder-165"></div>
<script src="/tradprofiles.js"></script>

<footer class="footer">   
  <div class="google-play-container">

  <a href='https://play.google.com/store/apps/details?id=com.datamb.datamb.webviewflutter&pcampaignid=pcampaignidMKT-Other-global-all-co-prtnr-py-PartBadge-Mar2515-1'><img alt='Get it on Google Play' src='https://play.google.com/intl/en_us/badges/static/images/badges/en_badge_web_generic.png'></a>
<a href='https://apps.apple.com/app/datamb/id6456224067?l=en-GB'><img alt='Download on the App Store' src='https://developer.apple.com/assets/elements/badges/download-on-the-app-store.svg'></a></div>
<div class="logo">
    <img src="https://datamb.football/logo.png" alt="Arsenal stats and data visuals. Arsenal compared to top 7 league teams in 2025/26. Arsenal club data profile, team radar comparison and plot chart" />
  </div>

  <p class="description">DataMB</p>
  <p class="info" data-i18n="footer.copyright">© All Rights Reserved</p>
  <hr class="divider" />
  <div class="sub-footer">
    <nav>
<a class="terms" data-i18n="footer.terms" target="_blank" href="https://datamb.football/privacy">Privacy</a>
<a class="privacy" data-i18n="footer.privacy" href="https://datamb.football/guide#contact">Contact</a>
<a class="glossary" data-i18n="footer.glossary" href="https://datamb.football/guide#aboutus">About</a>
</nav>
    <nav>
      <a target="_blank" href="https://twitter.com/datamb_" class="twitter-link">
        <svg width="23" height="22" fill="#000000" xmlns="http://www.w3.org/2000/svg">
          <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" />
        </svg>
      </a>
    </nav>
  </div>
</footer>
</div>
</body>
</html>



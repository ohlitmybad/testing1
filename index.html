<!DOCTYPE html>
<html>
<head>

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="robots" content="noindex">
<link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">

<script>
(function() {
      var width = window.innerWidth;
      console.log('Window width:', width);  // Debug log

      var initialScale = width / 470;
      console.log('Initial scale:', initialScale);  // Debug log

      var viewportMeta = document.querySelector('meta[name="viewport"]');
      viewportMeta.setAttribute('content', 'width=device-width, initial-scale=' + initialScale + ', user-scalable=no');
      console.log('Viewport meta updated with initial scale:', initialScale);  // Debug log
      
  })();
</script>
<defs>
<style>

body.dark-mode,
  body.dark-mode *:not(.similar-text):not(.player-text) {
    color: #f2f2f2;
  }
:root {
        --primary-color: #3498db;
        --secondary-color: #2ecc71;
        --background-color: #f5f7fa;
        --container-bg: #ffffff;
        --text-color: #333333;
        --border-color: #e0e0e0;
        --hover-color: #f0f0f0;
        --button-color: #3498db;
        --button-text: #ffffff;
        --header-bg: #ffffff;
        --shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        --table-bg: #f2f2f2;
    }

    .dark-mode {
        --primary-color: #3498db;
        --secondary-color: #2ecc71;
        --background-color: #0e0f0f;
        --container-bg: #1a1a1a;
        --text-color: #e0e0e0;
        --border-color: #333333;
        --hover-color: #252525;
        --button-color: #2980b9;
        --button-text: #ffffff;
        --header-bg: #0e0f0f;
        --shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        --table-bg: #333333;
    }


    body {
        font-family: 'Inter', sans-serif;
        color: var(--text-color);
        line-height: 1.6;
        margin: 0;
        padding: 0;
        width: 470px;
        overflow-x: hidden;
        position: relative;
        min-height: 100vh;
    }

#matchingNames {
  background-color: #ffffff;
  border-radius: 8px;
  box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.1);
}

body.dark-mode #matchingNames {
  background-color: #333333;
  box-shadow: 0px 4px 12px rgba(255, 253, 253, 0.1);
}

#matchingNames {
  scrollbar-width: thin;
  scrollbar-color: #c4c4c4 #f1f1f1;
}

body.dark-mode #matchingNames {
  scrollbar-color: #888888 #333333;
}

.name {
  padding: 9px 12px;
  font-size: 13px;
  color: #333333;
  cursor: pointer;
  display: flex;
  align-items: center;
  transition: background-color 0.2s ease-in-out;
font-family: Arial, sans-serif !important;
position: relative;
}

.name:hover {
  background-color: #f5f5f5;
}

body.dark-mode #matchingNames .name:hover {
  background-color: #444444;
}

.fullName {
  font-weight: bold;
  color: #333333;
  margin-right: 6px;
}

.age {
  color: #777777;
  margin-right: 4px;
}

.team {
  color: #777777;
}
	


/* Color classes for radar chart */
.result-color-1 {
  color: #3062FB !important;
  stroke: #3062FB;
  fill: #3062FB;
  fill-opacity: 0;
}
.result-color-2 {
  color: #F62681 !important;
  stroke: #F62681;
  fill: #F62681;
  fill-opacity: 0;
}
.result-color-3 {
  color: #55d149 !important;
  stroke: #55d149;
  fill: #55d149;
  fill-opacity: 0;
}
.result-color-4 {
  color: #FFCF5F !important;
  stroke: #FFCF5F;
  fill: #FFCF5F;
  fill-opacity: 0;
}
.result-color-5 {
  color: rgb(153, 50, 204) !important;
  stroke: rgb(153, 50, 204);
  fill: rgb(153, 50, 204);
  fill-opacity: 0;
}
.result-color-6 {
  color: rgb(255, 140, 0) !important;
  stroke: rgb(255, 140, 0);
  fill: rgb(255, 140, 0);
  fill-opacity: 0;
}

.result-color-7 {
  color: rgb(30, 144, 255) !important;
  stroke: rgb(30, 144, 255);
  fill: rgb(30, 144, 255);
  fill-opacity: 0;
}



.result-color-8 {
  color: rgb(240, 128, 128) !important;
  stroke: rgb(240, 128, 128);
  fill: rgb(240, 128, 128);
  fill-opacity: 0;
}




.result-color-9 {
    color: rgb(144, 238, 144) !important;
    stroke: rgb(144, 238, 144);
    fill: rgb(144, 238, 144);
    fill-opacity: 0;
}

.result-color-10 {
  color: rgb(135, 206, 235) !important;
  stroke: rgb(135, 206, 235);
  fill: rgb(135, 206, 235);
  fill-opacity: 0;
}




.result-color-11 {
  color: rgb(246, 38, 129) !important;
  stroke: rgb(246, 38, 129);
  fill: rgb(246, 38, 129);
  fill-opacity: 0;
}

.result-color-12 {
  color: rgb(255, 69, 0) !important;
  stroke: rgb(255, 69, 0);
  fill: rgb(255, 69, 0);
  fill-opacity: 0;
}

.result-color-13 {
  color: rgb(60, 179, 113) !important;
  stroke: rgb(60, 179, 113);
  fill: rgb(60, 179, 113);
  fill-opacity: 0;
}

.result-color-14 {
  color: rgb(138, 40, 165) !important;
  stroke: rgb(138, 40, 165);
  fill: rgb(138, 40, 165);
  fill-opacity: 0;
}

.result-color-15 {
  color: rgb(70, 130, 180) !important;
  stroke: rgb(70, 130, 180);
  fill: rgb(70, 130, 180);
  fill-opacity: 0;
}

.result-color-16 {
  color: rgb(208, 32, 144) !important;
  stroke: rgb(208, 32, 144);
  fill: rgb(208, 32, 144);
  fill-opacity: 0;
}




.result-color-17 {
  color: rgb(220, 20, 60) !important;
  stroke: rgb(220, 20, 60);
  fill: rgb(220, 20, 60);
  fill-opacity: 0;
}



.result-color-18 {
  color: rgb(255, 223, 60) !important;
  stroke: rgb(255, 223, 60);
  fill: rgb(255, 223, 60);
  fill-opacity: 0;
}


.result-color-19 {
  color: rgb(238, 130, 238) !important;
  stroke: rgb(238, 130, 238);
  fill: rgb(238, 130, 238);
  fill-opacity: 0;
}

.result-color-20 {
  color: rgb(147, 112, 219) !important;
  stroke: rgb(147, 112, 219);
  fill: rgb(147, 112, 219);
  fill-opacity: 0;
}



.result-color-21 {
  color: rgb(34, 139, 34) !important;
  stroke: rgb(34, 139, 34);
  fill: rgb(34, 139, 34);
  fill-opacity: 0;
}

.result-color-22 {
  color: rgb(255, 198, 0) !important;
  stroke: rgb(255, 198, 0);
  fill: rgb(255, 198, 0);
  fill-opacity: 0;
}




.result-color-23 {
  color: rgb(255, 99, 71) !important;
  stroke: rgb(255, 99, 71);
  fill: rgb(255, 99, 71);
  fill-opacity: 0;
}
.result-color-24 {
  color: rgb(65, 105, 225) !important;
  stroke: rgb(65, 105, 225);
  fill: rgb(65, 105, 225);
  fill-opacity: 0;
}
.result-color-25 {
  color: rgb(255, 215, 0) !important;
  stroke: rgb(255, 215, 0);
  fill: rgb(255, 215, 0);
  fill-opacity: 0;
}


.result-color-26 {
  color: rgb(0, 206, 209) !important;
  stroke: rgb(0, 206, 209);
  fill: rgb(0, 206, 209);
  fill-opacity: 0;
}
.result-color-27 {
  color: rgb(197, 142, 255) !important;
  stroke: rgb(197, 142, 255);
  fill: rgb(197, 142, 255);
  fill-opacity: 0;
}
.result-color-28 {
  color: rgb(46, 139, 87) !important;
  stroke: rgb(46, 139, 87);
  fill: rgb(46, 139, 87);
  fill-opacity: 0;
}
.result-color-29 {
  color: rgb(255, 105, 180) !important;
  stroke: rgb(255, 105, 180);
  fill: rgb(255, 105, 180);
  fill-opacity: 0;
}
.result-color-30 {
  color: rgb(255, 165, 0) !important;
  stroke: rgb(255, 165, 0);
  fill: rgb(255, 165, 0);
  fill-opacity: 0;
}
.result-color-31 {
  color: rgb(255, 207, 95) !important;
  stroke: rgb(255, 207, 95);
  fill: rgb(255, 207, 95);
  fill-opacity: 0;
}
.result-color-32 {
  color: rgb(255, 182, 193) !important;
  stroke: rgb(255, 182, 193);
  fill: rgb(255, 182, 193);
  fill-opacity: 0;
}
.result-color-33 {
  color: rgb(102, 205, 170) !important;
  stroke: rgb(102, 205, 170);
  fill: rgb(102, 205, 170);
  fill-opacity: 0;
}
.result-color-34 {
  color: rgb(48, 98, 251) !important;
  stroke: rgb(48, 98, 251);
  fill: rgb(48, 98, 251);
  fill-opacity: 0;
}
.result-color-35 {
  color: rgb(186, 85, 211) !important;
  stroke: rgb(186, 85, 211);
  fill: rgb(186, 85, 211);
  fill-opacity: 0;
}
.result-color-36 {
  color: rgb(123, 104, 238) !important;
  stroke: rgb(123, 104, 238);
  fill: rgb(123, 104, 238);
  fill-opacity: 0;
}
.result-color-37 {
  color: rgb(0, 128, 128) !important;
  stroke: rgb(0, 128, 128);
  fill: rgb(0, 128, 128);
  fill-opacity: 0;
}

body, html {
            margin: 0;
            padding: 0;
        }
        

        body a {
text-decoration: none;
	}
	
.icon2::before {
  content: "\f118";
  font-family: "Ionicons"; 
font-size: 18px;
}


text {
  font-family: Arial;
}





.x-cell {
  position: relative;
  display: flex;
  justify-content: center;
  margin-left: 10px;
  width: 30px;
}

.x-button {
  background-color: #f2f2f2;
  border: none;
  border-radius: 50%;
  width: 24px;
  height: 24px;
  font-size: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: background-color 0.2s ease;
}

.x-button:hover {
  background-color: #e0e0e0;
}

.dark-mode .x-button {
  background-color: #333333;
  color: #f2f2f2;
}

.dark-mode .x-button:hover {
  background-color: #444444;
}

td {
    display: flex;
    align-items: center;
}
  th {
    font-weight: normal;
  }

  tr {
  display: flex;
}


    img {
    width: 38px;
    margin-left: 10px;
    margin-bottom: 8px;
    opacity: 0.69;
   }


table {
  font-family: Arial;
  border-radius: 0px;
margin-top: 0%;
margin-left: 0%;
  table-layout: auto;
  margin-left:14px;
 
}

.similar-table {
  width: 300px;
  text-align: center;
  margin: 0;
  flex-grow: 1;
}


  



.dark-mode-toggle {
        position: fixed;
        bottom: 20px;
        right: 10px;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background-color: var(--container-bg);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: var(--shadow);
        z-index: 100;
        transition: background-color 0.3s;
    }

/* Removed old button-10 style */
    
    .screenshot-button:hover {
        background-color: #2980b9;
    }




	
  /* !!DARK MODE!!! */
  body.dark-mode .button-10 {
  border: 0.1px solid #000000; 
}



  body.dark-mode {
    background-color: #0F0F0E;
  }

 .dark-mode .x-button {
    background-color: #333333;
}


  body.dark-mode svg text.label {
    fill: #bcbcbc;
  }

  .dark-mode-toggle .toggle-icon::before {
  font-family: "Ionicons";
  content: "\f467"; 
  font-size: 26px; 
}

body.dark-mode .dark-mode-toggle {
  background-color: #333333;
}


body.dark-mode .dark-mode-toggle .toggle-icon::before {
  font-family: "Ionicons";
  content: "\f3b0"; 
  font-size: 16px; 
}


  body.dark-mode button {
  background-color: #333333;
}

body.dark-mode button,
body.dark-mode button:focus {
  color: #f2f2f2;
}

body.dark-mode button:hover {
  color: initial;
}

.position-switcher-container {
    display: flex;
    align-items: center;
    gap: 10px;
    max-width: 700px;
    flex-wrap: wrap;
    padding: 10px 12px;

}


.position-link {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 8px 12px;
    width: 40px; /* Fixed width for all position buttons */
    background-color: var(--container-bg);
    color: var(--text-color);
    text-decoration: none;
    border-radius: 6px;
    border: 1px solid var(--border-color);
    transition: all 0.2s ease;
    font-weight: 500;
    font-size: 14px;
}


.position-link:hover {
    background-color: var(--hover-color);
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

.position-link.active {
    background-color: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
}

/* Dark mode styles for position switcher */
.dark-mode .position-link {
    border-color: var(--border-color);
}

.dark-mode .position-link.active {
    background-color: var(--primary-color);
    border-color: var(--primary-color);
}

/* Responsive styles for position switcher */
@media screen and (max-width: 500px) {
    .position-switcher-container {
        gap: 8px;
    }
    
    .position-link {
        padding: 6px 10px;
        min-width: 36px;
        width: 45px; /* Slightly smaller fixed width for mobile */
        font-size: 13px;
    }
}


#searchInput1 {
        flex: 1;
        padding: 10px 12px;
        border: 1px solid var(--border-color);
        border-radius: 6px;
        font-size: 16px;
        outline: none;
        background-color: var(--container-bg);
        color: var(--text-color);
        transition: border-color 0.2s;
        height: 20px;
        margin-left: 12px;
        width: 377px;
        max-width: 100%;
    }

    #searchInput1:focus {
        border-color: var(--primary-color);
    }

    #searchInput1::placeholder {
        color: #999;
    }


    
    #searchButton1 {
        background-color: var(--button-color);
        color: var(--button-text) !important;
        border: none;
        border-radius: 6px;
        height: 36px;
        width: 36px;
        cursor: pointer;
        transition: background-color 0.2s;
        font-size: 18px;
        right: 25px; /* Position from the right edge */
        align-items: center;  /* Center vertically */
        justify-content: center;  /* Center horizontally */
        line-height: 1;  /* Fix line height */
        padding: 0;  /* Remove any padding */
    }


    #searchButton1:hover {
        background-color: #2980b9;
    }
    body.dark-mode #searchButton1:hover {
        background-color: #2980b9;
    }

    body.dark-mode #searchButton1 {
      background-color: var(--primary-color);
      border-color: var(--primary-color);    }



svg.radar {
  height: 391px;
  width: 391px;
  display: block; /* Add display block */
  margin: 0 auto; /* Center the radar chart */
}

/* Add specific styling for the SVG group */
svg.radar > g {
    transform-origin: center;
    transform: translate(50%, 50%); /* Center the group */
}

.logo-screenshot-container {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%;
  padding: 0 10px;
  box-sizing: border-box;
  margin-top: 20px;
  margin-bottom: 20px;
}

.logo-screenshot-container img {
  width: 38px;
  opacity: 0.64;
  margin-left: 5px;
  flex-shrink: 0;
}

.button-10 {
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: var(--button-color);
  color: var(--button-text);
  border: none;
  border-radius: 6px;
  height: 36px;
  width: 36px;
  cursor: pointer;
  transition: background-color 0.2s;
  margin-right: 10px;
  position: static;
  flex-shrink: 0;
}

</style>
</defs>
	
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7677714701428206"
     crossorigin="anonymous"></script>
	
</head>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-PSBMXX80EF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-PSBMXX80EF');
</script>


<body>
  <div class="screenshotcontainer">
    <div class="position-switcher-container">
      <a href="https://datamb.football/appgk/" target="_top" rel="noopener noreferrer" class="position-link">
          <span>GK</span>
      </a>
          <span class="position-link active" style="user-select: none;">
        <span>CB</span>
    </span>

      <a href="https://datamb.football/appfb/" target="_top" rel="noopener noreferrer" class="position-link">
          <span>FB</span>
      </a>
      <a href="https://datamb.football/appcm/" target="_top" rel="noopener noreferrer" class="position-link">
          <span>CM</span>
      </a>
      <a href="https://datamb.football/appfw/" target="_top" rel="noopener noreferrer" class="position-link">
          <span>FW</span>
      </a>
      <a href="https://datamb.football/appst/" target="_top" rel="noopener noreferrer" class="position-link">
          <span>ST</span>
      </a>
    </div>

    <div class="search-container">
      <div class="search-controls">
        <input type="text" id="searchInput1" class="search-bar" data-i18n="search.placeholder2" placeholder="Enter centreback name..." />
        <button id="searchButton1">+</button>
      </div>
      <div id="matchingNames"></div>
    </div>

    <div id="resultsTable"></div>
    
    <div class="radar-container" style="display: flex; justify-content: center; width: 100%; margin-top: 20px;">
      <svg class="radar">
        <g transform="translate(0,0)"><g class="axisWrapper">
          <g class="radar_label">
            <text class="label" data-type="Aerial%" data-idx="0" data-i18n="radar.a" transform="translate(-34 -170) rotate(-2)">Aerial%</text>
        </g>
        
        <g class="radar_label">
            <text class="label" data-type="Long%" data-idx="6" data-i18n="radar.b" transform="matrix(0.5, -0.86, 0.86, 0.5, -157, -76) rotate(5.5)">Duel%</text>
        </g>
        
        <g class="radar_label">
            <text class="label" data-type="Passes" data-idx="5" data-i18n="radar.c" transform="matrix(-0.38, -0.93, 0.93, -0.38, -152, 89) rotate(3.87)">Def Actions</text>
        </g>
        
        <g class="radar_label">
            <text class="label" data-type="Exits" data-idx="4" data-i18n="radar.d" transform="translate(-115 153) rotate(20.3)">Prog Passes</text>
        </g>
        
        <g class="radar_label">
            <text class="label" data-type="Aerial" data-idx="3" data-i18n="radar.e" transform="translate(58 179) rotate(-28.32)">Fwd Pass%</text>
        </g>
        
        <g class="radar_label">
            <text class="label" data-type="Def Actions" data-idx="2" data-i18n="radar.f" transform="translate(176 3.8) rotate(100.11)">Passes</text>
        </g>
        
        <g class="radar_label">
            <text class="label" data-type="Shotstopping" data-idx="1" data-i18n="radar.g" transform="translate(107 -142) rotate(51.09)">Carrying</text>
        </g>


<circle class="blackCircle" r="165" style="fill:none; stroke:#D3D3D3; stroke-width:1;"></circle>
<circle class="gridCircle" r="165" style="fill: rgb(16, 135, 188); fill-opacity: 0.03;"></circle>
<circle class="gridCircle" r="139" style="fill: rgb(16, 135, 188); fill-opacity: 0.03;"></circle>
<circle class="gridCircle" r="104" style="fill: rgb(16, 135, 188); fill-opacity: 0.03;"></circle>
<circle class="gridCircle" r="70" style="fill: rgb(16, 135, 188); fill-opacity: 0.03;"></circle>
<circle class="gridCircle" r="35" style="fill: rgb(16, 135, 188); fill-opacity: 0.03;"></circle>


<line x1="0" y1="0" x2="8.11" y2="164.74" stroke="#D3D3D3" stroke-width="1" transform="translate(-8.11, -164.74)"></line>
<line x1="0" y1="0" x2="-123.52" y2="109.77" stroke="#D3D3D3" stroke-width="1" transform="translate(123.25, -109.77)"></line>
<line x1="0" y1="0" x2="-162.88" y2="-28.1" stroke="#D3D3D3" stroke-width="1" transform="translate(163.09, 28.04)"></line>
<line x1="0" y1="0" x2="-79.86" y2="-145.15" stroke="#D3D3D3" stroke-width="1" transform="translate(79.86, 144.53)"></line>
<line x1="0" y1="0" x2="63.48" y2="-152.91" stroke="#D3D3D3" stroke-width="1" transform="translate(-63.48, 152.47)"></line>
<line x1="0" y1="0" x2="158.9" y2="-45.8" stroke="#D3D3D3" stroke-width="1" transform="translate(-158.89, 45.63)"></line>
<line x1="0" y1="0" x2="134.5" y2="95.58" stroke="#D3D3D3" stroke-width="1" transform="translate(-134.51, -95.67)"></line>


<g class="radarWrapper"></g>
</g></g>
      </svg>
    </div>
    
    <div class="logo-screenshot-container">
      <img src="https://datamb.football/logo.png" alt="Logo">
      <div id="similarPlayersContainer"></div>
      <button onclick="takeScreenshot()" class="button-10"><div class="icon2"></div></button>
    </div>
    
    <div id="insertHere"></div>
    <div class="dark-mode-toggle" onclick="toggleDarkMode()">
      <div class="toggle-icon"></div>

<script>
   

  const allData1 = [];
  const allData2 = [];
  let allDataAsString = '';
  

  
  const urls1 = [
  'https://datamb.football/database/CURRENT/RATOP72425/CB/CB.xlsx',
  
];

const urls2 = [
'https://datamb.football/database/OLD/RATOP72324/CB/CB.xlsx',


];



const fetchPromises1 = urls1.map(url => fetch(url).then(response => response.arrayBuffer()));
const fetchPromises2 = urls2.map(url => fetch(url).then(response => response.arrayBuffer()));

function processAndStoreData1(dataArray) {
    // Unique ID counter
    let uniqueIdCounter = 1;

    dataArray.forEach(data => {
        const workbook = XLSX.read(new Uint8Array(data), { type: 'array' });
        const sheetName = workbook.SheetNames[0];
        const sheet = workbook.Sheets[sheetName];
        const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });

        // Exclude header row
        const dataWithoutHeader = jsonData.slice(1);

        // Perform transformations and add unique ID
        dataWithoutHeader.forEach(row => {
            // Generate unique ID and shift columns
            row.unshift(`${uniqueIdCounter++}`);

            // Shift columns as needed
            row[14] = (row[9] * row[10]) / 100;  // Equivalent formula
            row[15] = `${row[1]} 23/24`;
              
            const reorderedRow = [
            row[0],
            row[15],
            row[2],
            row[3],
            row[14],
            row[11],
            row[12],
            row[5],
            row[6],
            row[7],
            row[8],
            row[4]
        ];

            allData1.push(reorderedRow);
        });
    });

    // Extract values from columns 4, 5, 6, 7, 8, 9, and 10
    const columnsToConvert = [4, 5, 6, 7, 8, 9, 10];
    const columnValues = columnsToConvert.map(col => allData1.map(row => parseFloat(row[col])));

    // Calculate percentiles
    const percentiles = columnValues.map(values => {
        const sorted = [...values].sort((a, b) => a - b);
        return values.map(value => {
            const rank = sorted.indexOf(value) + 1;
            return (rank / sorted.length);
        });
    });

    // Replace original values with percentiles
    allData1.forEach((row, rowIndex) => {
        columnsToConvert.forEach((col, colIndex) => {
            row[col] = percentiles[colIndex][rowIndex].toFixed(3);
        });
    });
}

function processAndStoreData(dataArray) {
    // Unique ID counter
    let uniqueIdCounter = 1;

    dataArray.forEach(data => {
        const workbook = XLSX.read(new Uint8Array(data), { type: 'array' });
        const sheetName = workbook.SheetNames[0];
        const sheet = workbook.Sheets[sheetName];
        const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });

        // Exclude header row
        const dataWithoutHeader = jsonData.slice(1);

        // Perform transformations and add unique ID
        dataWithoutHeader.forEach(row => {
            // Generate unique ID and shift columns
            row.unshift(`${uniqueIdCounter++}`);

            // Shift columns as needed
            row[14] = (row[9] * row[10]) / 100;  // Equivalent formula
            row[15] = `${row[1]} 24/25`;

            const reorderedRow = [
            row[0],
            row[15],
            row[2],
            row[3],
            row[14],
            row[11],
            row[12],
            row[5],
            row[6],
            row[7],
            row[8],
            row[4]
        ];

            allData2.push(reorderedRow);
        });
    });

    // Extract values from columns 4, 5, 6, 7, 8, 9, and 10
    const columnsToConvert = [4, 5, 6, 7, 8, 9, 10];
    const columnValues = columnsToConvert.map(col => allData2.map(row => parseFloat(row[col])));

    // Calculate percentiles
    const percentiles = columnValues.map(values => {
        const sorted = [...values].sort((a, b) => a - b);
        return values.map(value => {
            const rank = sorted.indexOf(value) + 1;
            return (rank / sorted.length);
        });
    });

    // Replace original values with percentiles
    allData2.forEach((row, rowIndex) => {
        columnsToConvert.forEach((col, colIndex) => {
            row[col] = percentiles[colIndex][rowIndex].toFixed(3);
        });
    });
}

Promise.all(fetchPromises1)
    .then(responses => {
        processAndStoreData(responses);

    
        // Fetch and process the remaining files
        Promise.all(fetchPromises2)
            .then(responses2 => {
                processAndStoreData1(responses2);

                // Concatenate intermediate data with new data
                const finalData = allData2.concat(allData1);

                // Reset and assign new unique IDs
                finalData.forEach((row, index) => {
                    row[0] = `${index + 1}`;
                });
                
                finalData.forEach(row => {
                    allDataAsString += row.join(',') + '\n';
                });


                const inputLines = allDataAsString.trim().split('\n');

      const outputLines = [];
  
      for (const line of inputLines) {
          // Split the line by comma
          const parts = line.split(',');

          // Extract the desired fields
          const name = parts[1];
          const age = parts[3];
          const club = parts[2];

          // Create the formatted string
          const outputLine = `${name},${age},${club}`;

          // Add the formatted string to the output array
          outputLines.push(outputLine);
      }

const names = outputLines;
const searchInput = document.getElementById('searchInput1');
      searchInput.setAttribute("autocomplete", "off");
 const matchingNamesContainer = document.getElementById("matchingNames");
const searchButton = document.getElementById("searchButton");


function updateMatchingNames() {
const searchQuery = removeSpecialChars(searchInput.value.toLowerCase());
const matchingNames = names.filter(function(name) {
const [fullName] = name.split(",");
  const normalizedName = removeSpecialChars(fullName.toLowerCase());
    return normalizedName.includes(searchQuery);
});

matchingNamesContainer.innerHTML = "";

matchingNames.forEach(function(name) {
  const [fullName, team, age] = name.split(",");

  const nameElement = document.createElement("div");
  nameElement.classList.add("name");

  const fullNameElement = document.createElement("span");
  fullNameElement.textContent = fullName;
  fullNameElement.classList.add("fullName");
  nameElement.appendChild(fullNameElement);

  const ageElement = document.createElement("span");
  ageElement.textContent = " (" + age + ",";
  ageElement.classList.add("age");
  nameElement.appendChild(ageElement);

  const teamElement = document.createElement("span");
  teamElement.textContent = " " + team + ")";
  teamElement.classList.add("team");
  nameElement.appendChild(teamElement);

  nameElement.addEventListener("click", function(event) {
    const clickedElement = event.target.closest(".name");
    if (clickedElement) {
      const fullName = clickedElement.querySelector(".fullName").textContent;
      const age = clickedElement.querySelector(".age").textContent.trim();
      const team = clickedElement.querySelector(".team").textContent
      .trim()
      .normalize('NFD')
      .replace(/[\u0300-\u036f\s]/g, '')
      .replace(/[^a-zA-Z]/g, '');  
      const searchQuery = fullName + "," + team + "," + age.substring(1, age.length - 1);
  
      searchInput.value = searchQuery; // Set the full query as the search input value
      const enterKeyEvent = new KeyboardEvent("keyup", { key: "Enter" });
      searchInput.dispatchEvent(enterKeyEvent); // Dispatch enter key event
    }
  });

  matchingNamesContainer.appendChild(nameElement);
              });
            
              if (searchQuery === "" && matchingNames.length === 0) {
                matchingNamesContainer.style.display = "none";
              } else {
                matchingNamesContainer.style.display = "block";
                matchingNamesContainer.style.padding = "8px";
                matchingNamesContainer.style.position = "relative";
                matchingNamesContainer.style.left = "13.3px";
                matchingNamesContainer.style.zIndex = "9999"; // Set a high z-index value
                matchingNamesContainer.style.width = "377px"; // Match the width of the search input
                matchingNamesContainer.style.maxHeight = "267px"; // Limit height for long lists
                matchingNamesContainer.style.overflowY = "auto"; // Enable scrolling if content exceeds height
          
                matchingNamesContainer.style.border = "1px solid #e0e0e0"; // Light gray border
              }
             
              if (searchQuery === "") {
                matchingNamesContainer.style.display = "none";
              }
            }

searchInput.addEventListener("input", updateMatchingNames);
searchInput.addEventListener("keyup", function(event) {
if (event.key === "Enter") {
  searchButton1.click(); // Trigger the search button click event
} else if (event.key === "Backspace") {
  updateMatchingNames();
}
});       




const csvData = allDataAsString;
let dataArray = csvData.trim().split('\n').map(line => line.split(','));




function calculateEuclideanDifference(data1, data2) {
let difference = 0;
for (let i = 4; i <= 10; i++) {
const metric1 = parseFloat(data1[i]);
const metric2 = parseFloat(data2[i]);
difference += Math.pow(metric1 - metric2, 2);
}
return Math.sqrt(difference);
}



const colorClasses = ['result-color-1', 'result-color-2', 'result-color-3', 'result-color-4', 'result-color-5', 'result-color-6', 'result-color-7', 'result-color-8', 'result-color-9', 'result-color-10', 'result-color-11', 'result-color-12', 'result-color-13', 'result-color-14', 'result-color-15', 'result-color-16', 'result-color-17', 'result-color-18', 'result-color-19', 'result-color-20', 'result-color-21', 'result-color-22', 'result-color-23', 'result-color-24', 'result-color-25', 'result-color-26', 'result-color-27', 'result-color-28', 'result-color-29', 'result-color-30', 'result-color-31', 'result-color-32', 'result-color-33', 'result-color-34', 'result-color-35', 'result-color-36', 'result-color-37'];

let searchResults = []; // Declare the search results variable


function removeSpecialChars(str) {
return str.normalize('NFD').replace(/[\u0300-\u036f\s]/g, '') 
.replace(/Ø/g, 'O')
.replace(/ø/g, 'o')
.replace(/ı/g, 'i');
}

function search(query) {
const queryParts = query.split(',').map(part => part.trim()); // Split the query by commas and trim whitespace
const name = queryParts[0]; // Extract the name part
let age, team;

// Extract age and team if they exist
if (queryParts.length > 1) {
age = queryParts[1].trim(); // Trim any leading or trailing spaces
if (queryParts.length > 2) {
team = queryParts[2].trim(); // Trim any leading or trailing spaces
}
}


const results = dataArray.filter(data => {
const normalizedName = removeSpecialChars(data[1].toLowerCase());
const normalizedTeam = removeSpecialChars(data[2].toLowerCase());
const normalizedAge = data[3].trim().toLowerCase(); // Trim any leading or trailing spaces


// Check if the name matches
const nameMatches = normalizedName.includes(removeSpecialChars(name.toLowerCase()));

// Check if the age matches (or if age is not provided)
const ageMatches = !age || normalizedAge === removeSpecialChars(age.toLowerCase());

// Check if the team matches (or if team is not provided)
const teamMatches = !team || normalizedTeam === removeSpecialChars(team.toLowerCase());

// Return true if name matches and either age or team matches
return nameMatches && ageMatches && teamMatches;
});

return results;
}


function createTable(teamName, teamIndex, color) {
const resultsTable = document.getElementById('resultsTable');

const headerNames = [
];

// Check if table headers exist
const headersExist = resultsTable.querySelector('th') !== null;

const table = headersExist ? resultsTable.querySelector('table') : document.createElement('table');
table.classList.add('metrics-table');

if (!headersExist) {
// Create the table header
const headerRow = document.createElement('tr');
for (let i = 1; i < headerNames.length; i++) {
const th = document.createElement('th');
th.textContent = headerNames[i];
headerRow.appendChild(th);
}
// We don't need a separate header for the x button anymore
table.appendChild(headerRow);
}




const teamData = dataArray[teamIndex];
const dataRow = document.createElement('tr');
dataRow.style.display = 'flex';
dataRow.style.alignItems = 'center';
dataRow.style.position = 'relative';

// Create a container for player data
const playerDataContainer = document.createElement('div');
playerDataContainer.style.display = 'flex';
playerDataContainer.style.alignItems = 'center';
playerDataContainer.style.flexGrow = '1';

for (let i = 1; i <= 11; i++) {
if (i === 1 || i === 2 || i === 3 || i === 11) {
const td = document.createElement('td');
if (i === 11) {
td.textContent = teamData[i] + ' min';
} else {
td.textContent = teamData[i] + ',';
}
td.classList.add(color);
playerDataContainer.appendChild(td);
}
}

dataRow.appendChild(playerDataContainer);

// Add a separate table cell for the "x" column
const xCell = document.createElement('td');
const xButton = document.createElement('button');
xButton.textContent = 'x';
xButton.classList.add('x-button');
xCell.classList.add('x-cell');
xButton.addEventListener('click', function () {
  dataRow.remove(); // Remove the corresponding row from the table
  const radarPolygons = document.querySelectorAll(`.radarPolygon.${color}`);
  const radarLines = document.querySelectorAll(`.radarLines.${color}`);
  const radarCircles = document.querySelectorAll(`.radarCircle.${color}`);

  radarPolygons.forEach((polygon) => polygon.remove());
  radarLines.forEach((line) => line.remove());
  radarCircles.forEach((circle) => circle.remove());

  // Get all remaining rows in the table
  const remainingRows = document.querySelectorAll('.metrics-table tr:not(:first-child)');
  
  if (remainingRows.length > 0) {
      // Get the last player's name from the last row
      const lastRow = remainingRows[remainingRows.length - 1];
      const lastPlayerName = lastRow.querySelector('td:first-child').textContent.split(',')[0];
      
      // Update similar players for the last remaining player
      const lastPlayerData = dataArray.find(player => player[1] === lastPlayerName);
      if (lastPlayerData) {
          updateSimilarPlayers(lastPlayerData);
      }
  } else {
      // If no players left, clear the similar players container
      const similarPlayersContainer = document.getElementById('similarPlayersContainer');
      if (similarPlayersContainer) {
          similarPlayersContainer.innerHTML = '';
      }
  }
});

xCell.appendChild(xButton);
dataRow.appendChild(xCell);

table.appendChild(dataRow);

if (!headersExist) {
resultsTable.appendChild(table);
}

const combResults = dataArray[teamIndex].join(', ');



const outerRadius = 130;
const center = [0, 0];
const angles = [0, 2 * Math.PI / 7, 4 * Math.PI / 7, 6 * Math.PI / 7, 8 * Math.PI / 7, 10 * Math.PI / 7, 12 * Math.PI / 7];

function axisValueToCartesian(axis, value) {
let angle = angles[axis - 1];
angle += (2 * Math.PI / 7) * 0.2;
const x = 165 * value * Math.cos(angle);
const y = 165 * value * Math.sin(angle);
return { x, y };
}

const svg = document.querySelector('.radar');
const radarWrapper = svg.appendChild(document.createElementNS('http://www.w3.org/2000/svg', 'g'));
radarWrapper.setAttribute('transform', 'translate(0,0)');
radarWrapper.innerHTML = '';

const data = [];
const rowCols = combResults.split(',');
for (let i = 4; i < 11; i++) {
data.push({ axis: i - 3, value: parseFloat(rowCols[i]) });
}

const points = data.map(({ axis, value }) => {
const { x, y } = axisValueToCartesian(axis, value);
return `${x},${y}`;
}).join(' ');

const polyline = document.createElementNS('http://www.w3.org/2000/svg', 'polyline');
polyline.setAttribute('class', `radarLines ${color}`); // Add the color class to the polyline
polyline.setAttribute('points', `${points} ${points.split(' ')[0]}`);
polyline.setAttribute('stroke-width', '3');
polyline.setAttribute('fill', 'none');
radarWrapper.appendChild(polyline);

const polygon = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
polygon.setAttribute('class', `radarPolygon ${color}`); // Add the color class to the polygon
polygon.setAttribute('points', points);
polygon.style.fillOpacity = '0.2';
radarWrapper.appendChild(polygon);

data.forEach(({ axis, value }) => {
const { x, y } = axisValueToCartesian(axis, value);
const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
circle.setAttribute('class', `radarCircle ${color}`); // Add the color class to the circle
circle.style.fillOpacity = '0.86'; // Set the opacity to 1 (fully opaque)
circle.setAttribute('r', '6');
circle.setAttribute('cx', x);
circle.setAttribute('cy', y);
radarWrapper.appendChild(circle);
});
}


function createTableForTeam1() {
const searchInput = document.getElementById('searchInput1');
const searchButton = document.getElementById('searchButton1');
const resultsTable = document.getElementById('resultsTable');


const teamNames = new Set(); // Keep track of unique team names

const teamNamesList = document.createElement('ul');
teamNamesList.style.fontFamily = 'Arial, sans-serif'; 
teamNamesList.style.listStyleType = 'none'; // Remove the bullet points
teamNamesList.style.paddingLeft = '9px'; // Adjust the padding to move it further left
resultsTable.appendChild(teamNamesList);


let searchCounter = 0; // Initialize search counter

searchButton.addEventListener('click', function () {
const searchQuery = searchInput.value;
const results = search(searchQuery);

if (results) {
const teamId = parseInt(results[0]); // Parse the team ID from the results

const teamName = results[1] + ' (' + results[2] + ', ' + results[3] + ') - ' + results[11] + ' min';
const color = colorClasses[searchCounter % colorClasses.length]; // Get the color class based on the search counter

if (!teamNames.has(teamName)) {

const teamNameItem = document.createElement('li');
teamNameItem.textContent = teamName;
teamNameItem.classList.add(color); // Apply the color class to the team name


createTable(teamName, teamId - 1, color); // Pass the team ID and color to createTable
searchCounter++;

}
} 

});


}



createTableForTeam1();



let colorIndex = 0; // Initialize color index

searchButton1.addEventListener("click", function() {
  const searchQuery = searchInput.value;
  const searchedPlayer = search(searchQuery);

  if (searchedPlayer.length > 0) {
      const searchedPlayerData = searchedPlayer[0];
      updateSimilarPlayers(searchedPlayerData);
      colorIndex++;
  }

  searchInput.value = '';
  updateMatchingNames();
});

function updateSimilarPlayers(playerData) {
  const searchedPlayerIndex = parseInt(playerData[0]) - 1;
  const similarPlayers = [];
  
  // Find the color class of the LAST player from their row in the table
  const playerRows = document.querySelectorAll('.metrics-table tr:not(:first-child)');
  let playerColor = '';
  if (playerRows.length > 0) {
      const lastPlayerRow = playerRows[playerRows.length - 1];
      const lastPlayerCell = lastPlayerRow.querySelector('td:first-child');
      // Get all color classes from the element
      const classes = Array.from(lastPlayerCell.classList);
      // Find the color class (starts with 'result-color-')
      playerColor = classes.find(cls => cls.startsWith('result-color-'));
  }
  
  for (let i = 0; i < dataArray.length; i++) {
      if (i !== searchedPlayerIndex) {
          const difference = calculateEuclideanDifference(playerData, dataArray[i]);
          similarPlayers.push({ index: i, difference: difference });
      }
  }

  similarPlayers.sort((a, b) => a.difference - b.difference);
  const mostSimilarPlayers = similarPlayers.slice(0, 3);

  const similarPlayersContainer = document.getElementById('similarPlayersContainer');
  similarPlayersContainer.innerHTML = ''; // Clear existing content

  const similarPlayerTable = document.createElement("table");
  similarPlayerTable.classList.add("similar-table");
  
  // Set width and alignment for the table
  similarPlayerTable.style.width = "100%";
  similarPlayerTable.style.textAlign = "center";

  const headerRow = document.createElement("tr");
  const headerCell = document.createElement("th");
  headerCell.setAttribute("colspan", "5");
  headerCell.innerHTML = `<span data-i18n="similar.to" class="similar-text">Similar data to</span> <span class="player-text">${playerData[1]}</span>`;
  // Use the last player's color class instead of the first one
  headerCell.classList.add(playerColor || colorClasses[colorIndex % colorClasses.length]);
  headerRow.appendChild(headerCell);
  similarPlayerTable.appendChild(headerRow);

  const similarPlayerRow = document.createElement("tr");

  for (let i = 0; i < mostSimilarPlayers.length; i++) {
      const playerIndex = mostSimilarPlayers[i].index;
      const playerName = dataArray[playerIndex][1];
      
      const playerCell = document.createElement("td");
      playerCell.textContent = playerName;
      playerCell.style.fontSize = "10.8px";
      playerCell.style.textDecoration = "underline";
      playerCell.style.cursor = "pointer";

      playerCell.addEventListener("click", function() {
          const searchInput = document.getElementById('searchInput1');
          const searchButton = document.getElementById('searchButton1');
          searchInput.value = playerName;
          searchButton.click();
      });

      similarPlayerRow.appendChild(playerCell);
  }

  similarPlayerTable.appendChild(similarPlayerRow);
  similarPlayersContainer.appendChild(similarPlayerTable);
  
  // Explicitly translate the newly added elements
  if (window.translations) {
    const translatable = similarPlayerTable.querySelectorAll('[data-i18n]');
    translatable.forEach(element => translateElement(element, window.translations));
  }
}

}) })
.catch(error => {
console.error('Error fetching or processing data:', error);
});


</script>
	  
<script>async function takeScreenshot() {
  const chartContainer = document.querySelector('.screenshotcontainer');
  const isDarkMode = document.body.classList.contains('dark-mode');
  
  try {
    const canvas = await html2canvas(chartContainer, {
scale: 2, 
backgroundColor: isDarkMode ? '#0F0F0E' : '#FFFFFF',
useCORS: true,
logging: false,
      foreignObjectRendering: false,
      onclone: function(clonedDoc) {
        const similarPlayersContainer = clonedDoc.getElementById('similarPlayersContainer');
        if (similarPlayersContainer) {
          similarPlayersContainer.style.display = 'none';
        }
        
        const positionSwitcher = clonedDoc.querySelector('.position-switcher-container');
        const searchContainer = clonedDoc.querySelector('.search-container');
        if (positionSwitcher) positionSwitcher.style.display = 'none';
        if (searchContainer) searchContainer.style.display = 'none';

        const radarSVG = clonedDoc.querySelector('.radar');
      if (radarSVG) {
        radarSVG.style.display = 'block';
        radarSVG.style.margin = '0 auto';
        const svgGroup = radarSVG.querySelector('g');
        if (svgGroup) {
          svgGroup.setAttribute('transform', 'translate(195.5, 195.5)');
        }
      }
      }
    });
    
    canvas.toBlob(blob => {
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = 'DataMB Screenshot.png';
      link.click();
    }, 'image/png');
    
  } catch (error) {
  }
}

  // Function to toggle dark mode
  function toggleDarkMode() {
    const body = document.querySelector("body");
    body.classList.toggle("dark-mode");

    // Store the user's preference in local storage
    const isDarkMode = body.classList.contains("dark-mode");
    localStorage.setItem("darkMode", isDarkMode);
  }

  // Check if user has a stored preference for dark mode
  const storedDarkMode = localStorage.getItem("darkMode");

  if (storedDarkMode === "true") {
    const body = document.querySelector("body");
    body.classList.add("dark-mode");
  }


  function getPreferredLanguage() {
// PRIORITY 1: Check URL parameter first
const urlParams = new URLSearchParams(window.location.search);
const langParam = urlParams.get('lang');
if (langParam) {
return langParam;
}
// PRIORITY 2: Check localStorage
const storedLang = localStorage.getItem('preferredLanguage');
if (storedLang) {
return storedLang;
}
// PRIORITY 3: Use browser language
return getBrowserLanguage() || 'en';
}

function getBrowserLanguage() {
return navigator.language.slice(0, 2);
}

function applyLanguage(language) {
console.log(language);

if (language === 'en') {
return;
}


fetch(`locales/${language}.json`)
.then(response => {
  return response.ok ? response.json() : null;
})
.then(translations => {
  // Only proceed if translations exist
  if (translations) {
      window.currentTranslations = translations;
          window.translations = translations;
      
    document.querySelectorAll('[data-i18n]').forEach(element => {
      translateElement(element, translations);
    });
    
    document.querySelector('meta[name="language"]').setAttribute('content', language);
    
    if (!window.translationObserver) {
      window.translationObserver = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
          if (mutation.type === 'childList') {
            mutation.addedNodes.forEach(function(node) {
              if (node.nodeType === 1) { // Element node
                if (node.hasAttribute && node.hasAttribute('data-i18n')) {
                  translateElement(node, translations);
                }
                const elements = node.querySelectorAll ? node.querySelectorAll('[data-i18n]') : [];
                elements.forEach(function(element) {
                  translateElement(element, translations);
                });
              }
            });
          }
        });
      });
      
      window.translationObserver.observe(document.body, {
        childList: true,
        subtree: true
      });
    }
  }
})
.catch(() => {
});
}

// Helper function to translate a single element
function translateElement(element, translations) {
  const keys = element.getAttribute('data-i18n').split('.');
  let value = translations;
  
  for (const key of keys) {
    if (value === undefined || value === null) break;
    value = value[key];
  }
  
  if (value) {
    if (element.tagName === 'META') {
      element.setAttribute('content', value);
    } else if (element.tagName === 'INPUT') {
      element.setAttribute('placeholder', value);
    } else if (value.includes('<')) {
      element.innerHTML = value;
    } else {
      element.textContent = value;
    }
  }
}

const preferredLanguage = getPreferredLanguage();
applyLanguage(preferredLanguage);

</script></div></div>
<center>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7677714701428206"
       crossorigin="anonymous"></script>
  <!-- radarplotsearch -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-7677714701428206"
       data-ad-slot="6673239737"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({});
  </script></center>
</body>
</html>

